<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>Data cleaning in python using pandas - Tainted Bits</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Tainted Bits"><meta name="msapplication-TileImage" content="/images/logo-header.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Tainted Bits"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Data cleaning is a very important part of any data science project as data scientist spend 80% of their time is this step of the project. But not very much attentions is given to the cleaning process"><meta property="og:type" content="article"><meta property="og:title" content="Data cleaning in python using pandas"><meta property="og:url" content="https://www.taintedbits.com/2017/12/04/data-cleaning-in-python-using-pandas/"><meta property="og:site_name" content="Tainted Bits"><meta property="og:description" content="Data cleaning is a very important part of any data science project as data scientist spend 80% of their time is this step of the project. But not very much attentions is given to the cleaning process"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://www.taintedbits.com/2017/12/04/data-cleaning-in-python-using-pandas/income-religion-data.png"><meta property="article:published_time" content="2017-12-04T05:14:04.000Z"><meta property="article:modified_time" content="2021-03-11T10:27:20.873Z"><meta property="article:author" content="D3xt3r"><meta property="article:tag" content="Python"><meta property="article:tag" content="Data Wrangling"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/2017/12/04/data-cleaning-in-python-using-pandas/income-religion-data.png"><meta property="twitter:creator" content="@0xd3xt3r"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.taintedbits.com/2017/12/04/data-cleaning-in-python-using-pandas/"},"headline":"Tainted Bits","image":["https://www.taintedbits.com/2017/12/04/data-cleaning-in-python-using-pandas/income-religion-data.png"],"datePublished":"2017-12-04T05:14:04.000Z","dateModified":"2021-03-11T10:27:20.873Z","author":{"@type":"Person","name":"D3xt3r"},"description":"Data cleaning is a very important part of any data science project as data scientist spend 80% of their time is this step of the project. But not very much attentions is given to the cleaning process"}</script><link rel="alternate" href="/atom.xml" title="Tainted Bits" type="application/atom+xml"><link rel="icon" href="/images/logo-header.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/railscasts.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-128181439-1" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-128181439-1")</script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/logo-header.png" alt="Tainted Bits" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/publications">Publication</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/0xd3xt3r"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2017-12-04T05:14:04.000Z" title="12/4/2017, 10:44:04 AM">2017-12-04</time></span><span class="level-item">Updated&nbsp;<time datetime="2021-03-11T10:27:20.873Z" title="3/11/2021, 3:57:20 PM">2021-03-11</time></span><span class="level-item"><a class="link-muted" href="/categories/Machine-Learning/">Machine Learning</a></span><span class="level-item">14 minutes read (About 2089 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Data cleaning in python using pandas</h1><div class="content"><p>Data cleaning is a very important part of any data science project as data scientist spend 80% of their time is this step of the project. But not very much attentions is given to the cleaning process and not much research efforts are put to create any sort of framework recently I came across an amazing paper titled as <strong>Tidy data</strong> by <strong>Hadley Wickham</strong> in <em>Journal of Statistical Software</em> in which he talks about common problems one might encounter in data cleaning and what a Tidy data looks like I couldn’t agree more to him, he has also created a R package <em>reshape</em> and <em>reshape2</em> for data cleaning, but the problem was the paper had very little to no code I also found the code version of the paper but it was in <em>R</em>, while most of my data cleaning work is done in pandas, I had to translate all those R solutions to pandas equivalent, so in this post the I will summarize all the main idea of the paper that the author suggests in the paper and also how we can solve it in pandas.</p><span id="more"></span><h2 id="Basic-terminology"><a href="#Basic-terminology" class="headerlink" title="Basic terminology"></a>Basic terminology</h2><p>It’s good to define terms that bring reads and writer on the same mindset. A <strong>data-set</strong> is a collection of values, usually either numbers (if quantitative) or strings (if qualitative). Values are organised in two ways.</p><ol><li>A <strong>Variable</strong> contains all values that measure the same underlying attribute (like height, temperature, duration) across units.</li><li>A <strong>Observation</strong> contains all values measured on the same unit (like a person, or a day, or a race) across attributes.</li></ol><p>Every value belongs to a <em>variable</em> and a <em>observation</em>. To make the terms more clear let consider an example of a user information example below:</p><table><thead><tr><th>Name</th><th>Age</th><th>Country</th><th>Gender</th></tr></thead><tbody><tr><td>Gustavo</td><td>24</td><td>Colombia</td><td>Male</td></tr><tr><td>Hussain</td><td>34</td><td>India</td><td>Male</td></tr><tr><td>Messy</td><td>35</td><td>Argentina</td><td>Male</td></tr><tr><td>Teresa</td><td>45</td><td>India</td><td>Female</td></tr></tbody></table><p>The above data-set have 16 values representing 4 variables and 4 observation. Which can be broken down as follow:</p><ol><li>There are 4 variable (name, age, country and gender)</li><li>Gender variable has two possible values(M/F) these kinds of variable are generally call categorical variables</li><li>Country variable as 3 distinct values.</li></ol><blockquote><p>Its really important to understand the terms observation and variable, as they will be extensively used in upcoming sections.</p></blockquote><h2 id="What-is-tidy-data"><a href="#What-is-tidy-data" class="headerlink" title="What is tidy data?"></a>What is tidy data?</h2><p>Once you have understood the concept of observation and variable we are ready to define what is tidy data. In tidy data:</p><ol><li>Each variable forms a column.</li><li>Each observation forms a row.</li><li>Each type of observational unit forms a table.</li></ol><p>This is Codd’s 3rd normal form (Codd 1990), Messy data is any other arrangement then this form. One might use various methods to extract variable but this might slow the analysis and invites error. Mapping rows, columns and tables to observation, variables and types will provide a good conceptual framework to map an entity to a functional form, for example, if you are are building a model to predict housing price based on features like location, area, number of rooms, etc. Price variable becomes a function of other variables of the table.</p><p>The author suggested that there are mainly five problems commonly observed in messy data which are as follows :</p><ol><li>Column headers are values, not variable names</li><li>Multiple variables are stored in one column</li><li>Variables are stored in both rows and columns</li><li>Multiple types of observational units are stored in the same table</li><li>A single observational unit is stored in multiple tables<br>for the rest of the post we will discuss what these problems look like and how to fix them.</li></ol><h2 id="Five-most-common-problems-with-messy-data-sets"><a href="#Five-most-common-problems-with-messy-data-sets" class="headerlink" title="Five most common problems with messy data-sets:"></a>Five most common problems with messy data-sets:</h2><h3 id="Column-headers-are-values-not-variable-names"><a href="#Column-headers-are-values-not-variable-names" class="headerlink" title="Column headers are values, not variable names"></a>Column headers are values, not variable names</h3><p>To better illustrate this problem lets consider are pewforum.org Income data of various religious group in the US. First 12 rows of the data is shown below</p><img src="/2017/12/04/data-cleaning-in-python-using-pandas/income-religion-data.png" title="Income distribution by religious group"><p>As you can see there are 6 columns which are religion, 4 income groups and sample size. You can see the problem here income variable is stored in the column header, just 3 variables <em>religion</em>, <em>income</em> and <em>sample size</em> would have been sufficient, the <em>income</em> variable would have 4 possible values ( &lt;30k / &gt;30k and &lt;50k / &gt;50k and &lt;100k / &gt;100k).</p><p>There are two main arguments as to why this form of representation is called messy :<br>1. Data in this format are usually designed for presentation not ideal for analysis.<br>2. Variables are presents in both columns and rows.</p><p>To solve this problem these issue there is a <em>melt</em> function in pandas which can be accessed as <strong>pandas.melt</strong> to perform this operation we need two parameters <em>id variable</em>(id_vars) and <em>value variables</em>(val_vars), <em>id variable</em> will we the variable to which the columns headers will be mapped, in this example we will choose <em>Religious tradition</em> as the <em>id variable</em> to 4 different values of income groups as <em>value variables</em>. You can see the problem of repeated values in <em>Religious tradition</em> variable which was mentioned before.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># religious_df is the dataframe which stores above table</span></span><br><span class="line">In [<span class="number">1</span>]: value_variables = [<span class="string">&#x27;Less than $30000&#x27;</span>,<span class="string">&#x27;$30000-$49999&#x27;</span>,<span class="string">&#x27;$50000-$99999&#x27;</span>,<span class="string">&#x27;$100000 or more&#x27;</span>]</span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: religious_df = religious_df.melt(id_vars=[<span class="string">&#x27;Religious tradition&#x27;</span>], value_vars=value_variables)</span><br><span class="line"></span><br><span class="line">In [<span class="number">3</span>]: religious_df[religious_df[<span class="string">&#x27;Religious tradition&#x27;</span>] == <span class="string">&#x27;Buddhist&#x27;</span>]</span><br><span class="line"></span><br><span class="line">Out[<span class="number">3</span>]:</span><br><span class="line">Religious tradition          variable  value</span><br><span class="line"><span class="number">0</span>             Buddhist  Less than $<span class="number">30000</span>     <span class="number">36</span></span><br><span class="line"><span class="number">12</span>            Buddhist     $<span class="number">30000</span>-$<span class="number">49999</span>     <span class="number">18</span></span><br><span class="line"><span class="number">24</span>            Buddhist     $<span class="number">50000</span>-$<span class="number">99999</span>     <span class="number">32</span></span><br><span class="line"><span class="number">36</span>            Buddhist   $<span class="number">100000</span> <span class="keyword">or</span> more     <span class="number">13</span></span><br></pre></td></tr></table></figure><p>There are good sides to this kind of data which are:<br>1. Values are sorted efficiently as there are no repeated values as you can see the tidy form of data below has repeated values, this problem can be dealt with table normalization.<br>2. Matrix operation can be done efficiently for example if we had another data of income of religious groups of Europe and we wanted to combine the data of both countries in one dataframe then simple matrix addition operation followed by value normalization would have solved the matter.</p><h3 id="Multiple-variables-are-stored-in-one-column"><a href="#Multiple-variables-are-stored-in-one-column" class="headerlink" title="Multiple variables are stored in one column"></a>Multiple variables are stored in one column</h3><p>This is usually due to the way data is represented, person’s full name is an example of this problem. Full name has 3 possible variable first name, middle name and surname, the first name indicating the person and middle name can point to another row in the table and surname can help you to find the group of people belonging to the same family for example in kaggle titanic data we can extract this column from full name. This procedure is similar to feature engineering sometimes, the gender variable must be missing but it can be extracted from the full name if the name has the title (Miss / Mr / Mrs / Ms).</p><p>Solution to this problem is to split the column having multiple variable into individual variable, in the full name example its simple as string split but in some case you may have to apply so logic. pandas has <em>apply</em> function which takes a function as a parameter, this function has the algorithm that runs on data to get derived value, <em>apply</em> function iterate thought each row and run the function passed on each element of the column.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: titanic_df = pd.read_csv(<span class="string">&#x27;../input/train.csv&#x27;</span>)</span><br><span class="line"><span class="comment"># run apply function on Name column of the data-set</span></span><br><span class="line">In [<span class="number">2</span>]: titanic_df[<span class="string">&#x27;surname&#x27;</span>] = titanic_df[<span class="string">&#x27;Name&#x27;</span>].apply(<span class="keyword">lambda</span> x : x.split(<span class="string">&#x27; &#x27;</span>)[-<span class="number">1</span>]).unique()</span><br></pre></td></tr></table></figure><h3 id="Variables-are-stored-in-both-rows-and-columns"><a href="#Variables-are-stored-in-both-rows-and-columns" class="headerlink" title="Variables are stored in both rows and columns"></a>Variables are stored in both rows and columns</h3><p>Variable stored in the column is the problem we have solved be before then why does is need another section to discuss it again. This is because if the variable is in the row then there will be a column which will hold the value of that variable, and that column will be sort of variable itself. Let take an example of Global Historical Climatology Network for one weather station (MX17004) in Mexico for five months in 2010.</p><p>Solution to this problem is to file melt the columns on the value columns using pandas <em>melt</em> function and then pivot the table on the row which has the variables <em>element</em> column for this example using pandas <em>pivot_table</em> method. Below is the code</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">In[<span class="number">1</span>]: station_df = pd.read_csv(<span class="string">&#x27;station.csv&#x27;</span>)</span><br><span class="line">In[<span class="number">2</span>]: station_df = station_df.melt(id_vars=[<span class="string">&#x27;year&#x27;</span>,<span class="string">&#x27;month&#x27;</span>,<span class="string">&#x27;element&#x27;</span>], value_vars=[<span class="string">&#x27;d1&#x27;</span>,<span class="string">&#x27;d2&#x27;</span>,<span class="string">&#x27;d3&#x27;</span>,<span class="string">&#x27;d4&#x27;</span>,<span class="string">&#x27;d5&#x27;</span>,<span class="string">&#x27;d6&#x27;</span>,<span class="string">&#x27;d7&#x27;</span>,<span class="string">&#x27;d8&#x27;</span>], var_name=<span class="string">&#x27;day&#x27;</span>, value_name=<span class="string">&#x27;temperature&#x27;</span>)</span><br><span class="line"></span><br><span class="line">In[<span class="number">3</span>]: station_df.rename(columns=&#123;<span class="string">&#x27;variable&#x27;</span>:<span class="string">&#x27;day&#x27;</span>,<span class="string">&#x27;value&#x27;</span>:<span class="string">&#x27;temperature&#x27;</span>&#125;,inplace=<span class="literal">True</span>)</span><br><span class="line">In [<span class="number">4</span>]: station_df.head()</span><br><span class="line">Out[<span class="number">4</span>]:</span><br><span class="line">    year  month element day  temperature</span><br><span class="line"><span class="number">0</span>   <span class="number">2010</span>      <span class="number">1</span>    tmax  d1         <span class="number">30.0</span></span><br><span class="line"><span class="number">1</span>   <span class="number">2010</span>      <span class="number">1</span>    tmin  d1          <span class="number">3.0</span></span><br><span class="line"><span class="number">2</span>   <span class="number">2010</span>      <span class="number">2</span>    tmax  d1         <span class="number">45.0</span></span><br><span class="line"><span class="number">3</span>   <span class="number">2010</span>      <span class="number">2</span>    tmin  d1         <span class="number">34.2</span></span><br><span class="line"><span class="number">4</span>   <span class="number">2010</span>      <span class="number">3</span>    tmax  d1          NaN</span><br><span class="line"><span class="comment"># remove the d from the day variable and convert it into integer</span></span><br><span class="line">In[<span class="number">5</span>]: station_df[<span class="string">&#x27;day&#x27;</span>] = station_df[<span class="string">&#x27;day&#x27;</span>].apply(<span class="keyword">lambda</span> x: x.replace(<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;&#x27;</span>))</span><br><span class="line"><span class="comment"># this will create dataframe in hierarchical index since there</span></span><br><span class="line"><span class="comment"># multiple index column specified in the index params</span></span><br><span class="line">In[<span class="number">6</span>]: station_df.pivot_table(index=[<span class="string">&#x27;year&#x27;</span>,<span class="string">&#x27;month&#x27;</span>,<span class="string">&#x27;day&#x27;</span>], values=<span class="string">&#x27;temperature&#x27;</span>, columns=<span class="string">&#x27;element&#x27;</span>)</span><br><span class="line"><span class="comment"># remove hierarchical index</span></span><br><span class="line">In[<span class="number">7</span>]: station_df.reset_index(inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>below are the first few rows of the cleaned data</p><table><thead><tr><th>element</th><th>year</th><th>month</th><th>day</th><th>tmax</th><th>tmin</th></tr></thead><tbody><tr><td>0</td><td>2010</td><td>1</td><td>1</td><td>30.0</td><td>3.0</td></tr><tr><td>1</td><td>2010</td><td>2</td><td>1</td><td>45.0</td><td>34.2</td></tr><tr><td>2</td><td>2010</td><td>2</td><td>2</td><td>27.3</td><td>14.4</td></tr><tr><td>3</td><td>2010</td><td>2</td><td>3</td><td>24.1</td><td>14.4</td></tr><tr><td>4</td><td>2010</td><td>2</td><td>6</td><td>20.0</td><td>21.0</td></tr></tbody></table><h3 id="Multiple-types-of-observational-units-are-stored-in-the-same-table"><a href="#Multiple-types-of-observational-units-are-stored-in-the-same-table" class="headerlink" title="Multiple types of observational units are stored in the same table"></a>Multiple types of observational units are stored in the same table</h3><p>This kind of problem arises due to the fact that multiple types of observation units are stored in the same table, this leads to the problem of duplicate values in dataframe so much so that size of the dataframe increases considerably. This concept is similar to that of database normalization where each fact is expressed in one place and if that fact has to be used somewhere else then the reference ID of that table is used.</p><p>let take an example of the billboard weekly ranking of the songs dataset set, this dataset has two type of observation unit, the songs and the weekly ranking. This is the reason there is repetition in values of <em>artist</em>, <em>tract</em> and <em>time</em> variables. We need the break down this dataset into two dataframe <em>songs</em> and <em>weekly rank</em></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: weekly_rank_df = pd.read_csv(<span class="string">&#x27;songs.csv&#x27;</span>)</span><br><span class="line"><span class="comment"># these are the repeated columns that we want to separate it</span></span><br><span class="line"><span class="comment"># out in other dataframe</span></span><br><span class="line">In [<span class="number">2</span>]: new_table_cols = [<span class="string">&#x27;artist&#x27;</span>, <span class="string">&#x27;track&#x27;</span>, <span class="string">&#x27;time&#x27;</span>]</span><br><span class="line"><span class="comment"># separate out the songs from the weekly ranks</span></span><br><span class="line"><span class="comment"># and drop duplicate entries in songs dataframe</span></span><br><span class="line">In [<span class="number">3</span>]: songs_df = weekly_rank_df[new_table_cols].drop_duplicates()</span><br><span class="line"><span class="comment"># remove old index value inherited from old weekly_rank table</span></span><br><span class="line">In [<span class="number">4</span>]: songs_df.reset_index(inplace=<span class="literal">True</span>, drop=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># get a new index values unique for each songs</span></span><br><span class="line">In [<span class="number">5</span>]: songs_df.reset_index(inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># give a good name to the index variable</span></span><br><span class="line">In [<span class="number">6</span>]: songs_df.rename(columns=&#123;<span class="string">&#x27;index&#x27;</span>:<span class="string">&#x27;song_id&#x27;</span>&#125;, inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># merge both the dataframe to assigned song_id to each weekly_rank</span></span><br><span class="line">In [<span class="number">7</span>]: weekly_rank_df = pd.merge(weekly_rank_df, songs_df, on=new_table, how=<span class="string">&#x27;inner&#x27;</span>)</span><br><span class="line"><span class="comment"># remove the columns of the songs dataframe from the weekly ranks dataframe</span></span><br><span class="line">In [<span class="number">8</span>]: weekly_rank_df.drop(columns=new_table_cols, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h3 id="A-single-observational-unit-is-stored-in-multiple-tables"><a href="#A-single-observational-unit-is-stored-in-multiple-tables" class="headerlink" title="A single observational unit is stored in multiple tables"></a>A single observational unit is stored in multiple tables</h3><p>It’s not very unusual to find this kind of problem same observation unit is spread across the various database, file format or different file, usually they are separated by another variable like the year, person etc. For example, the baby dataset top 129 name is in a different file, each file for a year so essentially each file depicting the year variable. Combining the data is not much difficult if the data source but the variable names remain consistent, but it becomes challenging when the data structure changes over time. Nonetheless, pandas is the perfect tool to deal this kind of problem for the following reason:</p><ol><li>It has methods to import data from a various source. You can find <em><em>pandas.read</em>*</em>_ functions that can import data from JSON, csv, database and various other file formats.</li><li>once we have imported the data in the dataframe pandas has various indexing mechanics like multilevel, hierarchal indexing to pick the observations of interest based on some value of the indexed variable.</li><li>pandas also have methods to merge different dataframe based on their indexing, as we discussed in the previous point indexing can not necessarily be a number but can be any shared variables of choice.</li></ol><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>We saw what a messy data is and defined what a tidy data should look like. We also discussed 5 most common problems of messy data and for each problem we discussed the messy table structure and who how we can fix it using few lines of pandas library.</p><h2 id="Useful-Links"><a href="#Useful-Links" class="headerlink" title="Useful Links"></a>Useful Links</h2><ol><li><a target="_blank" rel="noopener" href="https://www.jstatsoft.org/article/view/v059i10/v59i10.pdf">Tidy Data - Journal of Statistical Software</a></li><li><a target="_blank" rel="noopener" href="https://cran.r-project.org/web/packages/tidyr/vignettes/tidy-data.html">Tidy data blog post</a></li><li><a target="_blank" rel="noopener" href="https://aws.amazon.com/public-datasets/">Amazon Public data-set</a></li><li><a target="_blank" rel="noopener" href="https://r-dir.com/reference/datasets.html">More Data set</a></li></ol></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Python/">Python</a><a class="link-muted mr-2" rel="tag" href="/tags/Data-Wrangling/">Data Wrangling</a></div></article></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2018/03/25/reshaping-dataframe-using-pivot-and-melt-in-apache-spark-and-pandas/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Reshaping Dataframe using Pivot and Melt in Apache Spark and pandas</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2017/10/14/handling-categorical-features-in-python/"><span class="level-item">Handling categorical features with python</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config=function(){this.page.url="https://www.taintedbits.com/2017/12/04/data-cleaning-in-python-using-pandas/",this.page.identifier="2017/12/04/data-cleaning-in-python-using-pandas/"};!function(){var t=document,i=t.createElement("script");i.src="//taintedbits.disqus.com/embed.js",i.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(i)}()</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen order-1"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Basic-terminology"><span class="level-left"><span class="level-item">1</span><span class="level-item">Basic terminology</span></span></a></li><li><a class="level is-mobile" href="#What-is-tidy-data"><span class="level-left"><span class="level-item">2</span><span class="level-item">What is tidy data?</span></span></a></li><li><a class="level is-mobile" href="#Five-most-common-problems-with-messy-data-sets"><span class="level-left"><span class="level-item">3</span><span class="level-item">Five most common problems with messy data-sets:</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Column-headers-are-values-not-variable-names"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">Column headers are values, not variable names</span></span></a></li><li><a class="level is-mobile" href="#Multiple-variables-are-stored-in-one-column"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">Multiple variables are stored in one column</span></span></a></li><li><a class="level is-mobile" href="#Variables-are-stored-in-both-rows-and-columns"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">Variables are stored in both rows and columns</span></span></a></li><li><a class="level is-mobile" href="#Multiple-types-of-observational-units-are-stored-in-the-same-table"><span class="level-left"><span class="level-item">3.4</span><span class="level-item">Multiple types of observational units are stored in the same table</span></span></a></li><li><a class="level is-mobile" href="#A-single-observational-unit-is-stored-in-multiple-tables"><span class="level-left"><span class="level-item">3.5</span><span class="level-item">A single observational unit is stored in multiple tables</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Conclusion"><span class="level-left"><span class="level-item">4</span><span class="level-item">Conclusion</span></span></a></li><li><a class="level is-mobile" href="#Useful-Links"><span class="level-left"><span class="level-item">5</span><span class="level-item">Useful Links</span></span></a></li></ul></div></div><style>#toc .menu-list>li>a.is-active+.menu-list{display:block}#toc .menu-list>li>a+.menu-list{display:none}</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2021-02-14T18:30:00.000Z">2021-02-15</time></p><p class="title"><a href="/2021/02/15/arm-architecture-webinar/">ARM Architecture and Shellcode Webinars</a></p><p class="categories"><a href="/categories/Binary-Exploitation/">Binary Exploitation</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-06-06T18:30:00.000Z">2020-06-07</time></p><p class="title"><a href="/2020/06/07/binary-exploitation-pwnable-kr-level-6/">Binary Exploitation [pwnable.kr] - (Level 6) random</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-06-05T18:30:00.000Z">2020-06-06</time></p><p class="title"><a href="/2020/06/06/binary-exploitation-pwnable-kr-level-5/">Binary Exploitation [pwnable.kr] - (Level 5) passcode</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-05-16T18:30:00.000Z">2020-05-17</time></p><p class="title"><a href="/2020/05/17/binary-exploitation-pwnable-kr-level-4/">Binary Exploitation [pwnable.kr] - (Level 4) flag</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-05-15T18:30:00.000Z">2020-05-16</time></p><p class="title"><a href="/2020/05/16/binary-exploitation-pwnable-kr-level-3/">Binary Exploitation [pwnable.kr] - (Level 3) BOF</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Binary-Exploitation/"><span class="level-start"><span class="level-item">Binary Exploitation</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Brain-Logs/"><span class="level-start"><span class="level-item">Brain Logs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/CTF-Writeups/"><span class="level-start"><span class="level-item">CTF Writeups</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Exploitation/"><span class="level-start"><span class="level-item">Exploitation</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/IoT/"><span class="level-start"><span class="level-item">IoT</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Machine-Learning/"><span class="level-start"><span class="level-item">Machine Learning</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Malware-Analysis/"><span class="level-start"><span class="level-item">Malware Analysis</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/NLP/"><span class="level-start"><span class="level-item">NLP</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Reverse-Engineering/"><span class="level-start"><span class="level-item">Reverse Engineering</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/ACS712/"><span class="tag">ACS712</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Arduino/"><span class="tag">Arduino</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bare-Metal/"><span class="tag">Bare-Metal</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Chat-Bots/"><span class="tag">Chat Bots</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Classification/"><span class="tag">Classification</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Data-Wrangling/"><span class="tag">Data Wrangling</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dev/"><span class="tag">Dev</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dropper/"><span class="tag">Dropper</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ESP8266/"><span class="tag">ESP8266</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Editor/"><span class="tag">Editor</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Emacs/"><span class="tag">Emacs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Exploitation/"><span class="tag">Exploitation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GandCrab/"><span class="tag">GandCrab</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Grey-Energy/"><span class="tag">Grey Energy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kernel-Debugging/"><span class="tag">Kernel Debugging</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux-Malware/"><span class="tag">Linux Malware</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Malware-Analysis/"><span class="tag">Malware Analysis</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Regression/"><span class="tag">Regression</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reverse-Engineering/"><span class="tag">Reverse Engineering</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Visualization/"><span class="tag">Visualization</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows-Malware/"><span class="tag">Windows Malware</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows-Reversing/"><span class="tag">Windows Reversing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/glibc/"><span class="tag">glibc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript-obfuscation/"><span class="tag">javascript obfuscation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable/"><span class="tag">pwnable</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable-kr/"><span class="tag">pwnable-kr</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/radare2/"><span class="tag">radare2</span><span class="tag">4</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/logo-header.png" alt="Tainted Bits" height="28"></a><p class="is-size-7"><span>&copy; 2021 D3xt3r</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by-sa/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Subscribe" href="https://mailchi.mp/d744c1f04904/taintedbits"><i class="fa fa-envelope"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/0xd3xt3r"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en")</script><script>var IcarusThemeSettings={article:{highlight:{clipboard:!0,fold:"unfolded"}}}</script><script src="/js/column.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load",()=>{"function"==typeof $.fn.lightGallery&&$(".article").lightGallery({selector:".gallery-item"}),"function"==typeof $.fn.justifiedGallery&&($(".justified-gallery > p > .gallery-item").length&&$(".justified-gallery > p > .gallery-item").unwrap(),$(".justified-gallery").justifiedGallery())})</script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now</a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load",(function(){outdatedBrowser({bgColor:"#f25648",color:"#ffffff",lowerThan:"object-fit"})}))</script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener("DOMContentLoaded",(function(){loadInsight({contentUrl:"/content.json"},{hint:"Type something...",untitled:"(Untitled)",posts:"Posts",pages:"Pages",categories:"Categories",tags:"Tags"})}))</script></body></html>