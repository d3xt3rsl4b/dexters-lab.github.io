<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>Handling categorical features with python - Tainted Bits</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Tainted Bits"><meta name="msapplication-TileImage" content="/images/logo-header.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Tainted Bits"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="As a data scientist, you may very frequently encounter categorical variable in your dataset like location, car model, gender, etc. You cannot directly use them in our machine learning algorithm as the"><meta property="og:type" content="article"><meta property="og:title" content="Handling categorical features with python"><meta property="og:url" content="https://www.taintedbits.com/2017/10/14/handling-categorical-features-in-python/"><meta property="og:site_name" content="Tainted Bits"><meta property="og:description" content="As a data scientist, you may very frequently encounter categorical variable in your dataset like location, car model, gender, etc. You cannot directly use them in our machine learning algorithm as the"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://www.taintedbits.com/images/general-data-science-article-thumbnail.jpg"><meta property="article:published_time" content="2017-10-14T17:49:59.000Z"><meta property="article:modified_time" content="2021-03-11T10:27:20.877Z"><meta property="article:author" content="D3xt3r"><meta property="article:tag" content="Python"><meta property="article:tag" content="Data Wrangling"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/images/general-data-science-article-thumbnail.jpg"><meta property="twitter:creator" content="@0xd3xt3r"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.taintedbits.com/2017/10/14/handling-categorical-features-in-python/"},"headline":"Tainted Bits","image":["https://www.taintedbits.com/images/general-data-science-article-thumbnail.jpg"],"datePublished":"2017-10-14T17:49:59.000Z","dateModified":"2021-03-11T10:27:20.877Z","author":{"@type":"Person","name":"D3xt3r"},"description":"As a data scientist, you may very frequently encounter categorical variable in your dataset like location, car model, gender, etc. You cannot directly use them in our machine learning algorithm as the"}</script><link rel="alternate" href="/atom.xml" title="Tainted Bits" type="application/atom+xml"><link rel="icon" href="/images/logo-header.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/railscasts.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-128181439-1" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-128181439-1")</script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/logo-header.png" alt="Tainted Bits" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/publications">Publication</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/0xd3xt3r"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2017-10-14T17:49:59.000Z" title="10/14/2017, 11:19:59 PM">2017-10-14</time></span><span class="level-item">Updated&nbsp;<time datetime="2021-03-11T10:27:20.877Z" title="3/11/2021, 3:57:20 PM">2021-03-11</time></span><span class="level-item"><a class="link-muted" href="/categories/Machine-Learning/">Machine Learning</a></span><span class="level-item">10 minutes read (About 1491 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Handling categorical features with python</h1><div class="content"><p>As a data scientist, you may very frequently encounter categorical variable in your dataset like location, car model, gender, etc. You cannot directly use them in our machine learning algorithm as these algorithms only understand numbers. There are various techniques to convert these categorical features to numerical features but that is not the focus of this post, this post is about how to implement these techniques in python. I will talk a little bit about these techniques but won’t go into too much depth, I will emphasise more on various ways how you can implement this technique in python.</p><span id="more"></span><h2 id="What-are-Categorical-variables"><a href="#What-are-Categorical-variables" class="headerlink" title="What are Categorical variables?"></a>What are Categorical variables?</h2><p>Categorical variables are the qualitative variables which have non-numeric values like gender it can either be male/female value, even if they are numerical values feature description says it’s categorical that means these numerical values are not mathematically related. Sometimes the answer to the questions is like yes/no, ugly/nice/ok/pretty, good/bad, etc. We can say that answer to the question is from the set of predefined possibilities. Qualitative/categorical variables take values from these set of possibilities. These variables often prove to be of great importance and can boost the accuracy of the model to a considerable extent. There are two types of categorical variable :</p><h3 id="Ordinal-Ordered-categorical-variable"><a href="#Ordinal-Ordered-categorical-variable" class="headerlink" title="Ordinal/Ordered categorical variable"></a>Ordinal/Ordered categorical variable</h3><p>Order of these type of variables matter, for example, movie review values can be good, average and bad in this case average is between good and bad, rank result of a race, in such cases order of variable have some information and if the order is not followed can produce misleading results.</p><h3 id="Nominal-categorical-variable"><a href="#Nominal-categorical-variable" class="headerlink" title="Nominal categorical variable"></a>Nominal categorical variable</h3><p>For these type of variables order doesn’t matter, like the type of seat values can be economic/business, gender (male/female), etc. Order of the variable makes no difference in their interpretation.<br>It depends on the data we have whether to interpret a categorical variable as nominal or ordinal, misunderstand the variable can lead to a false result. So it really important to think carefully before diving into implementation.</p><h2 id="Simple-approach-to-encode-categorical-features"><a href="#Simple-approach-to-encode-categorical-features" class="headerlink" title="Simple approach to encode categorical features"></a>Simple approach to encode categorical features</h2><p>The two approaches which we are going to use to convert the categorical variable to its numerical equivalent form are as follows:</p><h3 id="Label-Encoding"><a href="#Label-Encoding" class="headerlink" title="Label Encoding"></a>Label Encoding</h3><p>A simple approach to convert categorical variable to numerical variable will to assign a unique number to each possible outcome of the variable and replace the variables values with its corresponding number. But this technique can only be used for the ordinal categorical variable, once you know the order of the values of the variable, as the order of the values matter the numbers assigned to values of categorical values should also be sorted in ascending or descending order, doesn’t matter which order you choose. So, for example, a movie review variable may have five possible in-order values (excellent, awesome, good, bad, burnt it) so assigned values for the outcome will be from 5 to 1, 5 been excellent and burn it been 1. In this case review variable, a value of one data point is 4 (awesome) and other data point is 2 bad and if we take average the outcome will be 3(good) which make sense. This might not be the case for the nominal variable which is why we cannot use this method for a nominal variable.</p><h3 id="One-Hot-Encoding-One-of-K-scheme"><a href="#One-Hot-Encoding-One-of-K-scheme" class="headerlink" title="One Hot Encoding/One of K scheme"></a>One Hot Encoding/One of K scheme</h3><p>The other approach is called the one hot encoding, where a categorical variable is converted into a binary vector, each possible value of the categorical variable becomes the variable itself with default value of zero and the variable which was the value of the categorical variable will have the value 1. This concept is explained with the example shown below.</p><p><strong>Table <em>before</em> applying <em>one hot encoding</em> transformation</strong><br>| name | gender |<br>|–|–|<br>| Roshan | male |<br>| Anna | female|<br>| Hussain | male |<br>| Ashwini | female |</p><p><strong>Table <em>after</em> applying <em>one hot encoding</em> transformation</strong><br>| name | male | female |<br>|–|–|–|<br>| Roshan | 1 | 0 |<br>| Anna | 0 | 1 |<br>| Hussain | 1 | 0 |<br>| Ashwini | 0 | 1 |</p><h2 id="Implementing-Label-Encoding"><a href="#Implementing-Label-Encoding" class="headerlink" title="Implementing Label Encoding"></a>Implementing Label Encoding</h2><p>We saw what label encoding is above, not always you are going to get categorical variable in string form, it is possible you might even encounter random numerical values(this is typically the case in competitions) but still it’s a categorical feature. To deal with such situation there is a utility class <em>LabelEncoder</em> in <em>preprocessing</em> module in the <em>sklearn</em> package it can handle categorical variable in both numerical and string form. Fire-up a <em>ipython</em> console and try the code below</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line"><span class="comment"># encoding numerical values</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num_encoder = LabelEncoder()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num_encoder.fit([<span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>])</span><br><span class="line">LabelEncoder()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num_encoder.classes_</span><br><span class="line">array([<span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>num_encoder.transform([<span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>])</span><br><span class="line">array([<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>le.inverse_transform([<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">array([<span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>])</span><br><span class="line"><span class="comment"># encoding string values</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>city_encoder = LabelEncoder()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>city_encoder.fit([<span class="string">&#x27;mumbai&#x27;</span>, <span class="string">&#x27;delhi&#x27;</span>, <span class="string">&#x27;mumbai&#x27;</span>, <span class="string">&#x27;pune&#x27;</span>])</span><br><span class="line">LabelEncoder()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(city_encoder.classes_)</span><br><span class="line">[<span class="string">&#x27;delhi&#x27;</span>, <span class="string">&#x27;mumbai&#x27;</span>, <span class="string">&#x27;pune&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>city_encoder.transform([<span class="string">&#x27;mumbai&#x27;</span>, <span class="string">&#x27;mumbai&#x27;</span>, <span class="string">&#x27;pune&#x27;</span>])</span><br><span class="line">array([<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">list</span>(city_encoder.inverse_transform([<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>]))</span><br><span class="line">[<span class="string">&#x27;mumbai&#x27;</span>, <span class="string">&#x27;pune&#x27;</span>, <span class="string">&#x27;mumbai&#x27;</span>]</span><br></pre></td></tr></table></figure><h2 id="Implementing-One-Hot-Encoding-One-of-K-Scheme"><a href="#Implementing-One-Hot-Encoding-One-of-K-Scheme" class="headerlink" title="Implementing One Hot Encoding/One of K-Scheme"></a>Implementing One Hot Encoding/One of K-Scheme</h2><p>You may encounter data in various form data type number/string to deal with these situations there are of utility classes in the <em>sklearn</em> package to convert them in one hot encoding schema. As we discussed earlier categorical variable could be in numerical or string data type, following are two methods to convert a categorical variable to one hot encoding schema:</p><h3 id="SKLearn-way"><a href="#SKLearn-way" class="headerlink" title="SKLearn way"></a>SKLearn way</h3><p><strong>OneHotEncoder</strong> utility class provided by the <em>sklearn</em> package can convert numerical values to one hot encoding but we can also deal with string values if use <em>LabelEncoder</em> along with the <em>OneHotEncoder</em> class. The <em>labelencoder</em> class will map the string values of the categorical variable to a number and these number can be converted to one hot encoding by <em>OneHotEncoder</em>. Implementation is shown by the code shown below</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: <span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder, OneHotEncoder</span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: <span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">In [<span class="number">3</span>]: raw_data = &#123;<span class="string">&#x27;name&#x27;</span>: [<span class="string">&#x27;Roshan&#x27;</span>,<span class="string">&#x27;Anna&#x27;</span>,<span class="string">&#x27;Hussain&#x27;</span>,<span class="string">&#x27;Ashwini&#x27;</span>],</span><br><span class="line">         <span class="string">&#x27;gender&#x27;</span>: [<span class="string">&#x27;male&#x27;</span>, <span class="string">&#x27;female&#x27;</span>, <span class="string">&#x27;male&#x27;</span>, <span class="string">&#x27;female&#x27;</span>]&#125;</span><br><span class="line"></span><br><span class="line">In [<span class="number">4</span>]: gender_encoder = LabelEncoder()</span><br><span class="line"></span><br><span class="line">In [<span class="number">5</span>]: df_people[<span class="string">&#x27;en_gender&#x27;</span>] = gender_encoder.fit_transform(df_people[<span class="string">&#x27;gender&#x27;</span>])</span><br><span class="line"></span><br><span class="line">In [<span class="number">6</span>]: df_people</span><br><span class="line">Out[<span class="number">6</span>]:</span><br><span class="line">       name  gender  en_gender</span><br><span class="line"><span class="number">0</span>   Roshan    male           <span class="number">1</span></span><br><span class="line"><span class="number">1</span>     Anna  female           <span class="number">0</span></span><br><span class="line"><span class="number">2</span>  Hussain    male           <span class="number">1</span></span><br><span class="line"><span class="number">3</span>  Ashwini  female           <span class="number">0</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">7</span>]:one_hot_array = one_hot_gender.fit_transform(df_people.en_gender.values.reshape(<span class="built_in">len</span>(df_people),<span class="number">1</span>))</span><br><span class="line">Out[<span class="number">7</span>]:</span><br><span class="line">array([[ <span class="number">0.</span>,  <span class="number">1.</span>],</span><br><span class="line">        [ <span class="number">1.</span>,  <span class="number">0.</span>],</span><br><span class="line">        [ <span class="number">0.</span>,  <span class="number">1.</span>],</span><br><span class="line">        [ <span class="number">1.</span>,  <span class="number">0.</span>]])</span><br><span class="line"></span><br><span class="line">In [<span class="number">8</span>]: df_people[gender_encoder.classes_] = pd.DataFrame(one_hot_array)</span><br><span class="line"></span><br><span class="line">In [<span class="number">9</span>]: df_people</span><br><span class="line">Out[<span class="number">9</span>]:</span><br><span class="line">      name  gender  en_gender  female  male</span><br><span class="line"><span class="number">0</span>   Roshan    male         <span class="number">1</span>     <span class="number">0.0</span>   <span class="number">1.0</span></span><br><span class="line"><span class="number">1</span>     Anna  female         <span class="number">0</span>     <span class="number">1.0</span>   <span class="number">0.0</span></span><br><span class="line"><span class="number">2</span>  Hussain    male         <span class="number">1</span>     <span class="number">0.0</span>   <span class="number">1.0</span></span><br><span class="line"><span class="number">3</span>  Ashwini  female         <span class="number">0</span>     <span class="number">1.0</span>   <span class="number">0.0</span></span><br></pre></td></tr></table></figure><h3 id="Pandas-way"><a href="#Pandas-way" class="headerlink" title="Pandas way"></a>Pandas way</h3><p>If your data is already loaded in pandas then <em>pandas.get_dummies</em> is one very handy method to convert your categorical variable to one hot encoding schema, this method is much convenient then the previous <em>sklearn</em> approach. This method can convert multiple columns in one method call by passing data frame and the columns we want to transform. Below is the example to for what I have just explained.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: <span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: raw_data = &#123;<span class="string">&#x27;name&#x27;</span>: [<span class="string">&#x27;Roshan&#x27;</span>,<span class="string">&#x27;Anna&#x27;</span>,<span class="string">&#x27;Hussain&#x27;</span>,<span class="string">&#x27;Ashwini&#x27;</span>],</span><br><span class="line">    ...: <span class="string">&#x27;gender&#x27;</span>: [<span class="string">&#x27;male&#x27;</span>, <span class="string">&#x27;female&#x27;</span>, <span class="string">&#x27;male&#x27;</span>, <span class="string">&#x27;female&#x27;</span>],</span><br><span class="line">    ...: <span class="string">&#x27;location&#x27;</span>: [<span class="string">&#x27;delhi&#x27;</span>, <span class="string">&#x27;delhi&#x27;</span>, <span class="string">&#x27;mumbai&#x27;</span>, <span class="string">&#x27;pune&#x27;</span>]&#125;</span><br><span class="line">    ...:</span><br><span class="line"></span><br><span class="line">In [<span class="number">3</span>]: df_people = pd.DataFrame(raw_data, columns = [<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>,<span class="string">&#x27;location&#x27;</span>])</span><br><span class="line"></span><br><span class="line">In [<span class="number">4</span>]: df_oh_p = pd.get_dummies(df_people, columns=[<span class="string">&#x27;gender&#x27;</span>, <span class="string">&#x27;location&#x27;</span>])</span><br><span class="line"></span><br><span class="line">In [<span class="number">5</span>]: df_oh_p</span><br><span class="line">Out[<span class="number">5</span>]:</span><br><span class="line">      name  gender_female  gender_male  location_delhi  location_mumbai  \</span><br><span class="line"><span class="number">0</span>   Roshan              <span class="number">0</span>            <span class="number">1</span>               <span class="number">1</span>                <span class="number">0</span></span><br><span class="line"><span class="number">1</span>     Anna              <span class="number">1</span>            <span class="number">0</span>               <span class="number">1</span>                <span class="number">0</span></span><br><span class="line"><span class="number">2</span>  Hussain              <span class="number">0</span>            <span class="number">1</span>               <span class="number">0</span>                <span class="number">1</span></span><br><span class="line"><span class="number">3</span>  Ashwini              <span class="number">1</span>            <span class="number">0</span>               <span class="number">0</span>                <span class="number">0</span></span><br><span class="line"></span><br><span class="line">   location_pune</span><br><span class="line"><span class="number">0</span>              <span class="number">0</span></span><br><span class="line"><span class="number">1</span>              <span class="number">0</span></span><br><span class="line"><span class="number">2</span>              <span class="number">0</span></span><br><span class="line"><span class="number">3</span>              <span class="number">1</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">6</span>]: df_people_new = pd.concat([df_people, df_oh_p], axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">7</span>]: df_people_new</span><br><span class="line">Out[<span class="number">7</span>]:</span><br><span class="line">      name  gender location     name  gender_female  gender_male  \</span><br><span class="line"><span class="number">0</span>   Roshan    male    delhi   Roshan              <span class="number">0</span>            <span class="number">1</span></span><br><span class="line"><span class="number">1</span>     Anna  female    delhi     Anna              <span class="number">1</span>            <span class="number">0</span></span><br><span class="line"><span class="number">2</span>  Hussain    male   mumbai  Hussain              <span class="number">0</span>            <span class="number">1</span></span><br><span class="line"><span class="number">3</span>  Ashwini  female     pune  Ashwini              <span class="number">1</span>            <span class="number">0</span></span><br><span class="line"></span><br><span class="line">   location_delhi  location_mumbai  location_pune</span><br><span class="line"><span class="number">0</span>               <span class="number">1</span>                <span class="number">0</span>              <span class="number">0</span></span><br><span class="line"><span class="number">1</span>               <span class="number">1</span>                <span class="number">0</span>              <span class="number">0</span></span><br><span class="line"><span class="number">2</span>               <span class="number">0</span>                <span class="number">1</span>              <span class="number">0</span></span><br><span class="line"><span class="number">3</span>               <span class="number">0</span>                <span class="number">0</span>              <span class="number">1</span></span><br></pre></td></tr></table></figure><p>We discussed two libraries <em>sklearn</em> and <em>pandas</em> which helps us to deal with the categorical variable, which one should you prefer? If you prefer <em>sklearn</em> way then you get advantage of chaining transformers and estimators in <em>PipeLine</em> and <em>FeatureUnion</em> to create data pipelines which can makes your whole analysis more manageable, while if you go pandas way you get the simplicity but you will have to implement custom transformer and then chain it in _PipeLine and <em>FeatureUnion</em>.</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>We saw the different type of categorical variable and how to encode them so that we can use them in machine learning algorithm along with other feature. You could write your own code to convert the categorical variables in numerical variable but you could leverage existing helpful utility classes/methods provided by some popular ML libraries which can come handy and can save some time in the cleaning of dirty data.</p><h2 id="Useful-links"><a href="#Useful-links" class="headerlink" title="Useful links"></a>Useful links</h2><ol><li><a target="_blank" rel="noopener" href="http://scikit-learn.org/stable/modules/classes.html#module-sklearn.feature_extraction">Feature extraction sklearn docs</a></li><li><a target="_blank" rel="noopener" href="https://www.quora.com/What-is-one-hot-encoding-and-when-is-it-used-in-data-science">What is one hot encoding and when is it used in data science? on Quora</a></li><li><a target="_blank" rel="noopener" href="http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.OneHotEncoder.html#sklearn.preprocessing.OneHotEncoder">OneHotEncoder sklearn API docs</a></li><li><a target="_blank" rel="noopener" href="http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html#sklearn.preprocessing.LabelEncoder">LabelEncoder sklearn API docs</a></li><li><a target="_blank" rel="noopener" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html">pandas.get_dummies API docs</a></li><li><a target="_blank" rel="noopener" href="http://scikit-learn.org/stable/modules/pipeline.html">sklearn Pipeline and FeatureUnion</a></li></ol></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Python/">Python</a><a class="link-muted mr-2" rel="tag" href="/tags/Data-Wrangling/">Data Wrangling</a></div></article></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2017/12/04/data-cleaning-in-python-using-pandas/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Data cleaning in python using pandas</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2017/10/02/visual-text-analytics-with-python/"><span class="level-item">Visual text Analytics with python</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config=function(){this.page.url="https://www.taintedbits.com/2017/10/14/handling-categorical-features-in-python/",this.page.identifier="2017/10/14/handling-categorical-features-in-python/"};!function(){var t=document,e=t.createElement("script");e.src="//taintedbits.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen order-1"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#What-are-Categorical-variables"><span class="level-left"><span class="level-item">1</span><span class="level-item">What are Categorical variables?</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Ordinal-Ordered-categorical-variable"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">Ordinal/Ordered categorical variable</span></span></a></li><li><a class="level is-mobile" href="#Nominal-categorical-variable"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">Nominal categorical variable</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Simple-approach-to-encode-categorical-features"><span class="level-left"><span class="level-item">2</span><span class="level-item">Simple approach to encode categorical features</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Label-Encoding"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">Label Encoding</span></span></a></li><li><a class="level is-mobile" href="#One-Hot-Encoding-One-of-K-scheme"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">One Hot Encoding/One of K scheme</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Implementing-Label-Encoding"><span class="level-left"><span class="level-item">3</span><span class="level-item">Implementing Label Encoding</span></span></a></li><li><a class="level is-mobile" href="#Implementing-One-Hot-Encoding-One-of-K-Scheme"><span class="level-left"><span class="level-item">4</span><span class="level-item">Implementing One Hot Encoding/One of K-Scheme</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#SKLearn-way"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">SKLearn way</span></span></a></li><li><a class="level is-mobile" href="#Pandas-way"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">Pandas way</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Conclusion"><span class="level-left"><span class="level-item">5</span><span class="level-item">Conclusion</span></span></a></li><li><a class="level is-mobile" href="#Useful-links"><span class="level-left"><span class="level-item">6</span><span class="level-item">Useful links</span></span></a></li></ul></div></div><style>#toc .menu-list>li>a.is-active+.menu-list{display:block}#toc .menu-list>li>a+.menu-list{display:none}</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2021-02-14T18:30:00.000Z">2021-02-15</time></p><p class="title"><a href="/2021/02/15/arm-architecture-webinar/">ARM Architecture and Shellcode Webinars</a></p><p class="categories"><a href="/categories/Binary-Exploitation/">Binary Exploitation</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-07-17T18:30:00.000Z">2020-07-18</time></p><p class="title"><a href="/2020/07/18/binary-exploitation-pwnable-tw-tcache-tear/">Binary Exploitation [pwnable.tw] - Tcache Tear</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-07-11T18:30:00.000Z">2020-07-12</time></p><p class="title"><a href="/2020/07/12/binary-exploitation-pwnable-tw-caov/">Binary Exploitation [pwnable.tw] - CAOV</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-07-10T18:30:00.000Z">2020-07-11</time></p><p class="title"><a href="/2020/07/11/binary-exploitation-pwnable-tw-spirited-away/">Binary Exploitation [pwnable.tw] - Spirited Away</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-07-04T18:30:00.000Z">2020-07-05</time></p><p class="title"><a href="/2020/07/05/binary-exploitation-pwnable-tw-realloc/">Binary Exploitation [pwnable.tw] - Realloc</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Binary-Exploitation/"><span class="level-start"><span class="level-item">Binary Exploitation</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Brain-Logs/"><span class="level-start"><span class="level-item">Brain Logs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/CTF-Writeups/"><span class="level-start"><span class="level-item">CTF Writeups</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/Exploitation/"><span class="level-start"><span class="level-item">Exploitation</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/IoT/"><span class="level-start"><span class="level-item">IoT</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Machine-Learning/"><span class="level-start"><span class="level-item">Machine Learning</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Malware-Analysis/"><span class="level-start"><span class="level-item">Malware Analysis</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/NLP/"><span class="level-start"><span class="level-item">NLP</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Reverse-Engineering/"><span class="level-start"><span class="level-item">Reverse Engineering</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/ACS712/"><span class="tag">ACS712</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Arduino/"><span class="tag">Arduino</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bare-Metal/"><span class="tag">Bare-Metal</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Chat-Bots/"><span class="tag">Chat Bots</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Classification/"><span class="tag">Classification</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Data-Wrangling/"><span class="tag">Data Wrangling</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dev/"><span class="tag">Dev</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dropper/"><span class="tag">Dropper</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ESP8266/"><span class="tag">ESP8266</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Editor/"><span class="tag">Editor</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Emacs/"><span class="tag">Emacs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Exploitation/"><span class="tag">Exploitation</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GandCrab/"><span class="tag">GandCrab</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Grey-Energy/"><span class="tag">Grey Energy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Heap-Exploitation/"><span class="tag">Heap Exploitation</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kernel-Debugging/"><span class="tag">Kernel Debugging</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">15</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux-Malware/"><span class="tag">Linux Malware</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Malware-Analysis/"><span class="tag">Malware Analysis</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ROP/"><span class="tag">ROP</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Regression/"><span class="tag">Regression</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reverse-Engineering/"><span class="tag">Reverse Engineering</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Visualization/"><span class="tag">Visualization</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/WarGames/"><span class="tag">WarGames</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows-Malware/"><span class="tag">Windows Malware</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows-Reversing/"><span class="tag">Windows Reversing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/glibc/"><span class="tag">glibc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript-obfuscation/"><span class="tag">javascript obfuscation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable/"><span class="tag">pwnable</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable-kr/"><span class="tag">pwnable-kr</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable-tw/"><span class="tag">pwnable-tw</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/radare2/"><span class="tag">radare2</span><span class="tag">4</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/logo-header.png" alt="Tainted Bits" height="28"></a><p class="is-size-7"><span>&copy; 2021 D3xt3r</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by-sa/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Subscribe" href="https://mailchi.mp/d744c1f04904/taintedbits"><i class="fa fa-envelope"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/0xd3xt3r"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en")</script><script>var IcarusThemeSettings={article:{highlight:{clipboard:!0,fold:"unfolded"}}}</script><script src="/js/column.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load",()=>{"function"==typeof $.fn.lightGallery&&$(".article").lightGallery({selector:".gallery-item"}),"function"==typeof $.fn.justifiedGallery&&($(".justified-gallery > p > .gallery-item").length&&$(".justified-gallery > p > .gallery-item").unwrap(),$(".justified-gallery").justifiedGallery())})</script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now</a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load",(function(){outdatedBrowser({bgColor:"#f25648",color:"#ffffff",lowerThan:"object-fit"})}))</script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener("DOMContentLoaded",(function(){loadInsight({contentUrl:"/content.json"},{hint:"Type something...",untitled:"(Untitled)",posts:"Posts",pages:"Pages",categories:"Categories",tags:"Tags"})}))</script></body></html>