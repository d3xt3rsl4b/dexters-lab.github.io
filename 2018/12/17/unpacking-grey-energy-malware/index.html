<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>Unpacking Grey Energy malware (Service Application DLL) - Tainted Bits</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Tainted Bits"><meta name="msapplication-TileImage" content="/images/logo-header.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Tainted Bits"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Recently I stumbled upon malware sample which was part of Grey Energy malware campaign targeting Ukraine energy infrastructure. I ran the hash of the file on virutotal and many of the antiviruses tagg"><meta property="og:type" content="article"><meta property="og:title" content="Unpacking Grey Energy malware (Service Application DLL)"><meta property="og:url" content="https://www.taintedbits.com/2018/12/17/unpacking-grey-energy-malware/"><meta property="og:site_name" content="Tainted Bits"><meta property="og:description" content="Recently I stumbled upon malware sample which was part of Grey Energy malware campaign targeting Ukraine energy infrastructure. I ran the hash of the file on virutotal and many of the antiviruses tagg"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://www.taintedbits.com/images/grey-energy-thumbnail.jpg"><meta property="article:published_time" content="2018-12-16T18:30:00.000Z"><meta property="article:modified_time" content="2021-03-11T10:27:20.917Z"><meta property="article:author" content="D3xt3r"><meta property="article:tag" content="Windows Malware"><meta property="article:tag" content="Grey Energy"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/images/grey-energy-thumbnail.jpg"><meta property="twitter:creator" content="@0xd3xt3r"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.taintedbits.com/2018/12/17/unpacking-grey-energy-malware/"},"headline":"Tainted Bits","image":["https://www.taintedbits.com/images/grey-energy-thumbnail.jpg"],"datePublished":"2018-12-16T18:30:00.000Z","dateModified":"2021-03-11T10:27:20.917Z","author":{"@type":"Person","name":"D3xt3r"},"description":"Recently I stumbled upon malware sample which was part of Grey Energy malware campaign targeting Ukraine energy infrastructure. I ran the hash of the file on virutotal and many of the antiviruses tagg"}</script><link rel="alternate" href="/atom.xml" title="Tainted Bits" type="application/atom+xml"><link rel="icon" href="/images/logo-header.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/railscasts.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-128181439-1" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-128181439-1")</script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/logo-header.png" alt="Tainted Bits" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/publications">Publication</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/0xd3xt3r"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2018-12-16T18:30:00.000Z" title="12/17/2018, 12:00:00 AM">2018-12-17</time></span><span class="level-item">Updated&nbsp;<time datetime="2021-03-11T10:27:20.917Z" title="3/11/2021, 3:57:20 PM">2021-03-11</time></span><span class="level-item"><a class="link-muted" href="/categories/Malware-Analysis/">Malware Analysis</a></span><span class="level-item">14 minutes read (About 2137 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Unpacking Grey Energy malware (Service Application DLL)</h1><div class="content"><p>Recently I stumbled upon malware sample which was part of <em>Grey Energy</em> malware campaign targeting Ukraine energy infrastructure. I ran the hash of the file on <a target="_blank" rel="noopener" href="https://www.virustotal.com/#/file/15a6f734ca79efc027000dd12f4d3870ccc9f604517b0e700c05b961659308d1/detection">virutotal</a> and many of the antiviruses tagged it Grey Energy and I tried to do a little more internet research but didn’t find and analysis on it. As there was no post on this sample so I decided to write one.<br>In the post you will learn the following:</p><ol><li>How to debug Windows Service Application DLL</li><li>Learn how to use a <em>EBFE</em> debugging technique</li><li>Unpacking a DLL binary</li><li>How to dump an unpacked in-memory executable</li></ol><p><strong>File hash</strong> : 15a6f734ca79efc027000dd12f4d3870ccc9f604517b0e700c05b961659308d1</p><span id="more"></span><h2 id="Identifying-the-Malware"><a href="#Identifying-the-Malware" class="headerlink" title="Identifying the Malware"></a>Identifying the Malware</h2><p>Using some basic static analysis tool you can know that it’s a 64-bit Windows DLL.</p><img src="/2018/12/17/unpacking-grey-energy-malware/basic-static-analysis.png" title="Basic Static Analysis"><p>Since it’s a DLL there we need to see the export table. There was only one function that was exported which is <strong>ServiceMain</strong>. This is the method is usually exported by <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/dotnet/framework/windows-services/introduction-to-windows-service-applications">Windows Service Application</a> DLL. This is the function which is invoked when a request is made to the <em>Windows Service Application</em>.</p><img src="/2018/12/17/unpacking-grey-energy-malware/file-export-section.png" title="DLL Export Section"><p>Checking the Import section you can see the below DLL been imported. But as we see the further analysis, not all the DLL which are imported are in use.</p><img src="/2018/12/17/unpacking-grey-energy-malware/file-export-section.png" title="DLL Import Section"><h2 id="Brief-Introduction-To-Windows-Service-Application"><a href="#Brief-Introduction-To-Windows-Service-Application" class="headerlink" title="Brief Introduction To Windows Service Application"></a>Brief Introduction To Windows Service Application</h2><p>If you know already know about <em>Windows Services</em> then I would advise you to skip this section. I will describe all the necessary stuff about <em>Windows Service</em> from malware authors perspective, but if you are interested to know more about it then you can refer to links in the reference section at the end of this post.</p><h3 id="What-is-a-Windows-Service"><a href="#What-is-a-Windows-Service" class="headerlink" title="What is a Windows Service?"></a>What is a Windows Service?</h3><p>Windows Service Application is to create long-running background application which you can start automatically when the system boot/reboot and it doesn’t have any user interface. Services can be put in the various state like start, stop, paused, resume and restarted, all this is managed by Windows Service Controller(services.exe). These features make it ideal for use as malware which does all its working in the background and its also long running starts on reboot. Actual use cases of <em>Services</em> are like Web Server service, logging machine performance metric like CPU, RAM etc. Service executable can be a DLL program with a defined entry point.</p><p>A service may be written to run as either a stand-alone process or as a part of the Service Control Manager’s(svchost.exe) process (which creates a thread per service, and the service is allowed to create more threads). If the service runs in SC, the SC creates the thread for a service then loads its DLL, and calls the Service entry points to move the service through its states (first start, then eventually stop). Since creating a thread from the svchost.exe process(a system service) giving it system privileges which can be dangerous, but you can run the DLL in the specific security context of the user account that can be different from logged-on user.</p><h3 id="Service-Application-requires-the-following-items"><a href="#Service-Application-requires-the-following-items" class="headerlink" title="Service Application requires the following items:"></a>Service Application requires the following items:</h3><p>To create a Service DLL you need to satisfy specific requirement which is as follows :</p><ol><li><strong>Main Entry point</strong>: this is required to register your service by calling <em>StartServiceCtrlDispatcher</em> this will be the DLL entry point.</li><li><strong>Service Entry point</strong>: which is <em>ServiceMain</em> in the DLL export entry, task to this function is as following tasks:<ol><li>Initialize any necessary items which we deferred from the DLL Entry Point.<br>Register the service control handler which will handle Service Stop, Pause, Continue, Shutdown, etc control commands.</li><li>Set Service Status to <em>SERVICE_PENDING</em> than to <em>SERVICE_RUNNING</em>. Set status to <em>SERVICE_STOPPED</em> on any errors and on exit.</li><li>Perform startup tasks. Like creating threads/events/mutex/IPCs/etc.</li></ol></li><li><strong>Service Control Handler</strong>: The Service Control Handler was registered in your <em>ServiceMain</em> Entry point. Each service must have a handler to handle control requests from the SCM. This handler will be called in the context of the SCM and will hold the SCM until it returns from the handler. Service Handler is called on various events like start, stop, paused etc which is passed as the parameter to the handler function.</li></ol><h2 id="Basic-Static-Analysis"><a href="#Basic-Static-Analysis" class="headerlink" title="Basic Static Analysis"></a>Basic Static Analysis</h2><p>We start with doing static analysis on the DllEntry point this might be the first function which might get executed even before <em>ServiceMain</em>. Below is the disassembly of the DllEntry point.</p><img src="/2018/12/17/unpacking-grey-energy-malware/dll-entry-point-dis.png" title="DllEntry function disassembly"><p>Looking at the disassembly further there was some memory allocation and manipulating of that memory. There was another interesting function which is found was at address <em>0x2c0202bc</em>, this function was called after allocation of memory which seems to be like a decryptor function, or at least preparing for so decryption. Below is the disassembly of this function.</p><img src="/2018/12/17/unpacking-grey-energy-malware/decryptor-func-dis.png" title="Suspected Decryptor function disassembly"><p>As there are a couple of XOR operations whose value is picked from register <em>rsp+0x68</em> and after some manipulation data is written to <em>[rbx+rsi*2]</em> translate to the same address. We can verify this in dynamic analysis. I am at this point little suspicious that the executable is packed as not many functions were recognized by both IDA and radare2 analysis.</p><p>Let us have look at the disassembly of the <em>ServiceMain</em>.</p><img src="/2018/12/17/unpacking-grey-energy-malware/service-main-dis.png" title="ServiceMain function disassembly"><p>These instruction doesn’t seem to make any sense. This further confirms our doubt of packed executable. We can use radare2 entropy calculation function to check the entropy if each segment in the execute. If there is any segment with high entropy then it means that section holds the encrypted data. We can use radare2 <em>iS entropy</em> command to calculate the entropy of each segment, below is the result of the command.</p><img src="/2018/12/17/unpacking-grey-energy-malware/segment-entropy.png" title="Entropy of each segment in the DLL"><p>As you can clearly see that <em>.text</em> segment has very high entropy compared to other segments. This confirms our suspicious of packed executable. In the next sections, we will try to setups debugging environment for <em>Service Application</em> as it is not as straight forward as other windows application and extract the unpacked executable using dynamic analysis.</p><h2 id="How-to-debug-a-Service-Application-DLL"><a href="#How-to-debug-a-Service-Application-DLL" class="headerlink" title="How to debug a Service Application DLL"></a>How to debug a Service Application DLL</h2><p>If this would have been a normal DLL we could just used Immunity debugger to do debugging but Service Application DLL is different as they have to register themselves and declare their state as running within first few seconds of execution, and also before running the main entry point the Service Control Manager(SCM) should be aware that the Service is going to run and the DLL runs only in the context of the SCM.</p><p>So the challenge is that we cannot get hold of the DLL entry point with ad debugger. We could overcome this limitation if we could manage to pause the execution of the DLL entry point when the SCM run the DLL.</p><p>After doing some research I came across a technique called <strong>EBFE</strong>, you can read more about on this <a target="_blank" rel="noopener" href="http://paulslaboratory.blogspot.com/2014/04/ebfe-debugging-remote-thread.html">link</a>. In this technique, we insert an infinite loop at the point we want to insert the breakpoint, once the thread executes this instruction it puts it in an infinite loop. <em>EBFE</em> is a jump instruction code which points to itself, this will put the executing thread in an infinite loop and then we all the time in the world to attach the debugger to the process and start debugging the process.</p><p>Next question is how will we know which subprocess spawned by SCM should we attach the debugger to? It’s actually very simple, once the CPU executes the infinite loop instruction the CPU consumption value will rise to very high-value something like 90-100%. We can use process explorer one of the System Internal tools to get the process ID of the process.</p><img src="/2018/12/17/unpacking-grey-energy-malware/process-explorer-infinite-loop.png" title="Process Explorer"><p>As you can see in the image above once the CPU executes <strong>EBFE</strong> instruction it goes in an infinite loop which increases the CPU consumption to 95-100% which is the indicator that our process is ready to be attached.</p><p>Now that we have figured out how to attach the debugger to <em>Service Application</em>, next thing is we have to place this instruction at a point which will get executed which is the entry point of the DLL. There are two points of interest at which we are can place EBFE are, ServiceMain(Service entry point) and DllEntry (DLL entry point). We will place this EBFE instruction on both of these functions. Before replacing the two-byte instruction you will have to take note of the original two bytes which you are replacing. Once the hit the infinite loop we will replace it with the original bytes and continue debugging.</p><h2 id="Dynamically-unpacking-the-packed-code"><a href="#Dynamically-unpacking-the-packed-code" class="headerlink" title="Dynamically unpacking the packed code"></a>Dynamically unpacking the packed code</h2><p>Let us start with analyzing DllEntry point since out of those two functions only this function had some sensible code.</p><p>First, the memory is allocated for the size of the original executable, the way it allocates the memory is something weird, it specifies the base address of memory block it wants to allocate, if it fails then it iterates from 100000h at the interval of 10000h tries to allocate the memory. We will have to note down this address as the unpacked executable will be on this address.</p><img src="/2018/12/17/unpacking-grey-energy-malware/allocate-memory-dis.png" title="Memory allocation disassembly"><p>then it changes the memory permission of the allocated memory and copies each segment (.text, .rdata, ) to newly allocated memory.</p><img src="/2018/12/17/unpacking-grey-energy-malware/copy-segments-dis.png" title="Memory allocation disassembly"><p>then it patches the current DLL entry point with the DllEntry point function in unpacked code. Before patching the memory address it changes the memory permission to writable then restore it back to <em>Read and Execute</em>.</p><img src="/2018/12/17/unpacking-grey-energy-malware/patch-dll-entry-point-dis.png" title="Patch the DllEntry point with the original entry point"><p>It then iterates the Import Address Table(IAT) of the unpacked DLL and it loads the DLL present in the IAT and resolves the imported functions and patches it in the table.</p><img src="/2018/12/17/unpacking-grey-energy-malware/resolve-iat-dis.png" title="Resolving the unpacked Import Address table"><p>this is the stage at with code is unpacked and the IAT is resolved next the code jump to the original DllEntry point for execution.</p><h2 id="Dumping-the-unpacked-code"><a href="#Dumping-the-unpacked-code" class="headerlink" title="Dumping the unpacked code"></a>Dumping the unpacked code</h2><p>The memory address which we noted earlier in the address at which the executable is unpacked as you can see in the dump below.</p><img src="/2018/12/17/unpacking-grey-energy-malware/pe-dump.png" title="PE Memory view of the unpacked malware"><p>We will use Scylla plugin which built-in in X64-dbg to dump the executable. You will have to specify the base address of the executable and the size of memory you want to use to recover the PE which you can see from the memory panel next to the <em>address</em> column and <em>size</em> of the debugger which is 23000 in our case and click the dump PE to save the executable file.</p><img src="/2018/12/17/unpacking-grey-energy-malware/dump-pe-view.png" title="PE Memory view of the unpacked malware"><h2 id="Unpacked-Binary"><a href="#Unpacked-Binary" class="headerlink" title="Unpacked Binary"></a>Unpacked Binary</h2><p>Unpacked binary basic information is as shown below</p><img src="/2018/12/17/unpacking-grey-energy-malware/unpacked-binary-info.png" title="Unpacked binary overview"><p>Import section of the unpacked binary</p><img src="/2018/12/17/unpacking-grey-energy-malware/unpacked-import-section-view-1.png" title="Unpacked binary Import Section"><p>Some more of the import section which shows binary uses HTTP for communication with the C&amp;C</p><img src="/2018/12/17/unpacking-grey-energy-malware/unpacked-import-section-view-2.png" title="Unpacked binary Import Section"><p>We can see the registering of the service in <em>ServiceMain</em> function by calling <em>RegisterServiceCtrlHandleW</em> and <em>SetServiceStatus</em>, that means we can be sure it was indeed as Service Application.</p><img src="/2018/12/17/unpacking-grey-energy-malware/unpacked-service-main.png" title="Unpacked ServiceMain function disassembly"><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>We managed to unpack the Service Application DLL, this packer was specially designed DLLs was we observed the unpacking of the binary as then patching of the DllEntry point to the original code. It was not a special anti-debug technique used in unpacking which made it very trivial which good to learn for a beginner. We also learnt how to dump in-memory binary along the way.</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol><li><a target="_blank" rel="noopener" href="https://www.codeproject.com/Articles/499465/Simple-Windows-Service-in-Cplusplus">Creating Windows Service Application in C++</a></li><li><a target="_blank" rel="noopener" href="https://code.msdn.microsoft.com/windowsapps/CppWindowsService-cacf4948">Windows Service Application MSDN</a></li><li><a target="_blank" rel="noopener" href="http://paulslaboratory.blogspot.com/2014/04/ebfe-debugging-remote-thread.html">Debugging Remote Thread with EBFE technique</a></li></ol></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Windows-Malware/">Windows Malware</a><a class="link-muted mr-2" rel="tag" href="/tags/Grey-Energy/">Grey Energy</a></div></article></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2019/02/16/analyzing-the-windows-lnk-file-attack-method/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Analyzing the Windows LNK file attack method</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2018/10/18/gandcrab-detail-analysis-of-js-delivery-payload/"><span class="level-item">Gandcrab v5.0.3 detail analysis of javascript delivery payload</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config=function(){this.page.url="https://www.taintedbits.com/2018/12/17/unpacking-grey-energy-malware/",this.page.identifier="2018/12/17/unpacking-grey-energy-malware/"};!function(){var e=document,t=e.createElement("script");t.src="//taintedbits.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)}()</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen order-1"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Identifying-the-Malware"><span class="level-left"><span class="level-item">1</span><span class="level-item">Identifying the Malware</span></span></a></li><li><a class="level is-mobile" href="#Brief-Introduction-To-Windows-Service-Application"><span class="level-left"><span class="level-item">2</span><span class="level-item">Brief Introduction To Windows Service Application</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#What-is-a-Windows-Service"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">What is a Windows Service?</span></span></a></li><li><a class="level is-mobile" href="#Service-Application-requires-the-following-items"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">Service Application requires the following items:</span></span></a></li></ul></li><li><a class="level is-mobile" href="#Basic-Static-Analysis"><span class="level-left"><span class="level-item">3</span><span class="level-item">Basic Static Analysis</span></span></a></li><li><a class="level is-mobile" href="#How-to-debug-a-Service-Application-DLL"><span class="level-left"><span class="level-item">4</span><span class="level-item">How to debug a Service Application DLL</span></span></a></li><li><a class="level is-mobile" href="#Dynamically-unpacking-the-packed-code"><span class="level-left"><span class="level-item">5</span><span class="level-item">Dynamically unpacking the packed code</span></span></a></li><li><a class="level is-mobile" href="#Dumping-the-unpacked-code"><span class="level-left"><span class="level-item">6</span><span class="level-item">Dumping the unpacked code</span></span></a></li><li><a class="level is-mobile" href="#Unpacked-Binary"><span class="level-left"><span class="level-item">7</span><span class="level-item">Unpacked Binary</span></span></a></li><li><a class="level is-mobile" href="#Conclusion"><span class="level-left"><span class="level-item">8</span><span class="level-item">Conclusion</span></span></a></li><li><a class="level is-mobile" href="#Reference"><span class="level-left"><span class="level-item">9</span><span class="level-item">Reference</span></span></a></li></ul></div></div><style>#toc .menu-list>li>a.is-active+.menu-list{display:block}#toc .menu-list>li>a+.menu-list{display:none}</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2021-02-14T18:30:00.000Z">2021-02-15</time></p><p class="title"><a href="/2021/02/15/arm-architecture-webinar/">ARM Architecture and Shellcode Webinars</a></p><p class="categories"><a href="/categories/Binary-Exploitation/">Binary Exploitation</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-06-06T18:30:00.000Z">2020-06-07</time></p><p class="title"><a href="/2020/06/07/binary-exploitation-pwnable-kr-level-6/">Binary Exploitation [pwnable.kr] - (Level 6) random</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-06-05T18:30:00.000Z">2020-06-06</time></p><p class="title"><a href="/2020/06/06/binary-exploitation-pwnable-kr-level-5/">Binary Exploitation [pwnable.kr] - (Level 5) passcode</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-05-16T18:30:00.000Z">2020-05-17</time></p><p class="title"><a href="/2020/05/17/binary-exploitation-pwnable-kr-level-4/">Binary Exploitation [pwnable.kr] - (Level 4) flag</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-05-15T18:30:00.000Z">2020-05-16</time></p><p class="title"><a href="/2020/05/16/binary-exploitation-pwnable-kr-level-3/">Binary Exploitation [pwnable.kr] - (Level 3) BOF</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Binary-Exploitation/"><span class="level-start"><span class="level-item">Binary Exploitation</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Brain-Logs/"><span class="level-start"><span class="level-item">Brain Logs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/CTF-Writeups/"><span class="level-start"><span class="level-item">CTF Writeups</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Exploitation/"><span class="level-start"><span class="level-item">Exploitation</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/IoT/"><span class="level-start"><span class="level-item">IoT</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Machine-Learning/"><span class="level-start"><span class="level-item">Machine Learning</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Malware-Analysis/"><span class="level-start"><span class="level-item">Malware Analysis</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/NLP/"><span class="level-start"><span class="level-item">NLP</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Reverse-Engineering/"><span class="level-start"><span class="level-item">Reverse Engineering</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/ACS712/"><span class="tag">ACS712</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Arduino/"><span class="tag">Arduino</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bare-Metal/"><span class="tag">Bare-Metal</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Chat-Bots/"><span class="tag">Chat Bots</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Classification/"><span class="tag">Classification</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Data-Wrangling/"><span class="tag">Data Wrangling</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dev/"><span class="tag">Dev</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dropper/"><span class="tag">Dropper</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ESP8266/"><span class="tag">ESP8266</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Editor/"><span class="tag">Editor</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Emacs/"><span class="tag">Emacs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Exploitation/"><span class="tag">Exploitation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GandCrab/"><span class="tag">GandCrab</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Grey-Energy/"><span class="tag">Grey Energy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kernel-Debugging/"><span class="tag">Kernel Debugging</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux-Malware/"><span class="tag">Linux Malware</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Malware-Analysis/"><span class="tag">Malware Analysis</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Regression/"><span class="tag">Regression</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reverse-Engineering/"><span class="tag">Reverse Engineering</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Visualization/"><span class="tag">Visualization</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows-Malware/"><span class="tag">Windows Malware</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows-Reversing/"><span class="tag">Windows Reversing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/glibc/"><span class="tag">glibc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript-obfuscation/"><span class="tag">javascript obfuscation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable/"><span class="tag">pwnable</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable-kr/"><span class="tag">pwnable-kr</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/radare2/"><span class="tag">radare2</span><span class="tag">4</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/logo-header.png" alt="Tainted Bits" height="28"></a><p class="is-size-7"><span>&copy; 2021 D3xt3r</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by-sa/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Subscribe" href="https://mailchi.mp/d744c1f04904/taintedbits"><i class="fa fa-envelope"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/0xd3xt3r"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en")</script><script>var IcarusThemeSettings={article:{highlight:{clipboard:!0,fold:"unfolded"}}}</script><script src="/js/column.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load",()=>{"function"==typeof $.fn.lightGallery&&$(".article").lightGallery({selector:".gallery-item"}),"function"==typeof $.fn.justifiedGallery&&($(".justified-gallery > p > .gallery-item").length&&$(".justified-gallery > p > .gallery-item").unwrap(),$(".justified-gallery").justifiedGallery())})</script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now</a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load",(function(){outdatedBrowser({bgColor:"#f25648",color:"#ffffff",lowerThan:"object-fit"})}))</script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener("DOMContentLoaded",(function(){loadInsight({contentUrl:"/content.json"},{hint:"Type something...",untitled:"(Untitled)",posts:"Posts",pages:"Pages",categories:"Categories",tags:"Tags"})}))</script></body></html>